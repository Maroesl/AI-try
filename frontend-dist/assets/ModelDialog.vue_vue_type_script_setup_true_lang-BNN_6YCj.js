const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/capabilityDetector-BSvar9Da.js","assets/index-CNFTjEvq.js","assets/index-GanuqZQ0.css"])))=>i.map(i=>d[i]);
var rt=Object.defineProperty;var it=(i,e,t)=>e in i?rt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var k=(i,e,t)=>it(i,typeof e!="symbol"?e+"":e,t);import{k as F,G as Z,D as ye,r as I,E as Ie,s as ot,d as Q,c as A,i as w,m as j,n as v,b as l,y as lt,F as de,q as he,f as M,z as J,e as U,Q as ge,t as L,T as at,x as ut,p as te,v as O,g as Fe,X as ct,B as Ee}from"./index-CNFTjEvq.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=F("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=F("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=F("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=F("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=F("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=F("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=F("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=F("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ke(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var _=ke();function Ve(i){_=i}var se={exec:()=>null};function T(i,e=""){let t=typeof i=="string"?i:i.source,s={replace:(r,n)=>{let o=typeof n=="string"?n:n.source;return o=o.replace(z.caret,"$1"),t=t.replace(r,o),s},getRegex:()=>new RegExp(t,e)};return s}var z={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:i=>new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}#`),htmlBeginRegex:i=>new RegExp(`^ {0,${Math.min(3,i-1)}}<(?:[a-z].*>|!--)`,"i")},ht=/^(?:[ \t]*(?:\n|$))+/,gt=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ft=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ne=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,mt=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ve=/(?:[*+-]|\d{1,9}[.)])/,Ke=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,We=T(Ke).replace(/bull/g,ve).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),bt=T(Ke).replace(/bull/g,ve).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),we=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xt=/^[^\n]+/,Te=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,yt=T(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Te).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),kt=T(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ve).getRegex(),ce="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",$e=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,vt=T("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",$e).replace("tag",ce).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),_e=T(we).replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ce).getRegex(),wt=T(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",_e).getRegex(),Ae={blockquote:wt,code:gt,def:yt,fences:ft,heading:mt,hr:ne,html:vt,lheading:We,list:kt,newline:ht,paragraph:_e,table:se,text:xt},Le=T("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ce).getRegex(),Tt={...Ae,lheading:bt,table:Le,paragraph:T(we).replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Le).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ce).getRegex()},$t={...Ae,html:T(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",$e).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:se,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:T(we).replace("hr",ne).replace("heading",` *#{1,6} *[^
]`).replace("lheading",We).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},At=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,St=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ze=/^( {2,}|\\)\n(?!\s*$)/,Pt=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pe=/[\p{P}\p{S}]/u,Se=/[\s\p{P}\p{S}]/u,Qe=/[^\s\p{P}\p{S}]/u,Rt=T(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Se).getRegex(),He=/(?!~)[\p{P}\p{S}]/u,Ct=/(?!~)[\s\p{P}\p{S}]/u,Mt=/(?:[^\s\p{P}\p{S}]|~)/u,It=/\[[^\[\]]*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,Je=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Et=T(Je,"u").replace(/punct/g,pe).getRegex(),Ut=T(Je,"u").replace(/punct/g,He).getRegex(),Xe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",zt=T(Xe,"gu").replace(/notPunctSpace/g,Qe).replace(/punctSpace/g,Se).replace(/punct/g,pe).getRegex(),Ot=T(Xe,"gu").replace(/notPunctSpace/g,Mt).replace(/punctSpace/g,Ct).replace(/punct/g,He).getRegex(),Lt=T("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Qe).replace(/punctSpace/g,Se).replace(/punct/g,pe).getRegex(),Nt=T(/\\(punct)/,"gu").replace(/punct/g,pe).getRegex(),Dt=T(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),jt=T($e).replace("(?:-->|$)","-->").getRegex(),Gt=T("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",jt).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),le=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`[^`]*`|[^\[\]\\`])*?/,Bt=T(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",le).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ye=T(/^!?\[(label)\]\[(ref)\]/).replace("label",le).replace("ref",Te).getRegex(),et=T(/^!?\[(ref)\](?:\[\])?/).replace("ref",Te).getRegex(),qt=T("reflink|nolink(?!\\()","g").replace("reflink",Ye).replace("nolink",et).getRegex(),Pe={_backpedal:se,anyPunctuation:Nt,autolink:Dt,blockSkip:It,br:Ze,code:St,del:se,emStrongLDelim:Et,emStrongRDelimAst:zt,emStrongRDelimUnd:Lt,escape:At,link:Bt,nolink:et,punctuation:Rt,reflink:Ye,reflinkSearch:qt,tag:Gt,text:Pt,url:se},Ft={...Pe,link:T(/^!?\[(label)\]\((.*?)\)/).replace("label",le).getRegex(),reflink:T(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",le).getRegex()},fe={...Pe,emStrongRDelimAst:Ot,emStrongLDelim:Ut,url:T(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Vt={...fe,br:T(Ze).replace("{2,}","*").getRegex(),text:T(fe.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},re={normal:Ae,gfm:Tt,pedantic:$t},X={normal:Pe,gfm:fe,breaks:Vt,pedantic:Ft},Kt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ne=i=>Kt[i];function N(i,e){if(e){if(z.escapeTest.test(i))return i.replace(z.escapeReplace,Ne)}else if(z.escapeTestNoEncode.test(i))return i.replace(z.escapeReplaceNoEncode,Ne);return i}function De(i){try{i=encodeURI(i).replace(z.percentDecode,"%")}catch{return null}return i}function je(i,e){var n;let t=i.replace(z.findPipe,(o,a,u)=>{let c=!1,h=a;for(;--h>=0&&u[h]==="\\";)c=!c;return c?"|":" |"}),s=t.split(z.splitPipe),r=0;if(s[0].trim()||s.shift(),s.length>0&&!((n=s.at(-1))!=null&&n.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;r<s.length;r++)s[r]=s[r].trim().replace(z.slashPipe,"|");return s}function Y(i,e,t){let s=i.length;if(s===0)return"";let r=0;for(;r<s&&i.charAt(s-r-1)===e;)r++;return i.slice(0,s-r)}function Wt(i,e){if(i.indexOf(e[1])===-1)return-1;let t=0;for(let s=0;s<i.length;s++)if(i[s]==="\\")s++;else if(i[s]===e[0])t++;else if(i[s]===e[1]&&(t--,t<0))return s;return t>0?-2:-1}function Ge(i,e,t,s,r){let n=e.href,o=e.title||null,a=i[1].replace(r.other.outputLinkReplace,"$1");s.state.inLink=!0;let u={type:i[0].charAt(0)==="!"?"image":"link",raw:t,href:n,title:o,text:a,tokens:s.inlineTokens(a)};return s.state.inLink=!1,u}function _t(i,e,t){let s=i.match(t.other.indentCodeCompensation);if(s===null)return e;let r=s[1];return e.split(`
`).map(n=>{let o=n.match(t.other.beginningSpace);if(o===null)return n;let[a]=o;return a.length>=r.length?n.slice(r.length):n}).join(`
`)}var ae=class{constructor(i){k(this,"options");k(this,"rules");k(this,"lexer");this.options=i||_}space(i){let e=this.rules.block.newline.exec(i);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(i){let e=this.rules.block.code.exec(i);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:Y(t,`
`)}}}fences(i){let e=this.rules.block.fences.exec(i);if(e){let t=e[0],s=_t(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(i){let e=this.rules.block.heading.exec(i);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let s=Y(t,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(t=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(i){let e=this.rules.block.hr.exec(i);if(e)return{type:"hr",raw:Y(e[0],`
`)}}blockquote(i){let e=this.rules.block.blockquote.exec(i);if(e){let t=Y(e[0],`
`).split(`
`),s="",r="",n=[];for(;t.length>0;){let o=!1,a=[],u;for(u=0;u<t.length;u++)if(this.rules.other.blockquoteStart.test(t[u]))a.push(t[u]),o=!0;else if(!o)a.push(t[u]);else break;t=t.slice(u);let c=a.join(`
`),h=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${c}`:c,r=r?`${r}
${h}`:h;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,n,!0),this.lexer.state.top=f,t.length===0)break;let d=n.at(-1);if((d==null?void 0:d.type)==="code")break;if((d==null?void 0:d.type)==="blockquote"){let m=d,p=m.raw+`
`+t.join(`
`),g=this.blockquote(p);n[n.length-1]=g,s=s.substring(0,s.length-m.raw.length)+g.raw,r=r.substring(0,r.length-m.text.length)+g.text;break}else if((d==null?void 0:d.type)==="list"){let m=d,p=m.raw+`
`+t.join(`
`),g=this.list(p);n[n.length-1]=g,s=s.substring(0,s.length-d.raw.length)+g.raw,r=r.substring(0,r.length-m.raw.length)+g.raw,t=p.substring(n.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:n,text:r}}}list(i){let e=this.rules.block.list.exec(i);if(e){let t=e[1].trim(),s=t.length>1,r={type:"list",raw:"",ordered:s,start:s?+t.slice(0,-1):"",loose:!1,items:[]};t=s?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=s?t:"[*+-]");let n=this.rules.other.listItemRegex(t),o=!1;for(;i;){let u=!1,c="",h="";if(!(e=n.exec(i))||this.rules.block.hr.test(i))break;c=e[0],i=i.substring(c.length);let f=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,$=>" ".repeat(3*$.length)),d=i.split(`
`,1)[0],m=!f.trim(),p=0;if(this.options.pedantic?(p=2,h=f.trimStart()):m?p=e[1].length+1:(p=e[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,h=f.slice(p),p+=e[1].length),m&&this.rules.other.blankLine.test(d)&&(c+=d+`
`,i=i.substring(d.length+1),u=!0),!u){let $=this.rules.other.nextBulletRegex(p),E=this.rules.other.hrRegex(p),C=this.rules.other.fencesBeginRegex(p),V=this.rules.other.headingBeginRegex(p),R=this.rules.other.htmlBeginRegex(p);for(;i;){let b=i.split(`
`,1)[0],x;if(d=b,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),x=d):x=d.replace(this.rules.other.tabCharGlobal,"    "),C.test(d)||V.test(d)||R.test(d)||$.test(d)||E.test(d))break;if(x.search(this.rules.other.nonSpaceChar)>=p||!d.trim())h+=`
`+x.slice(p);else{if(m||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||C.test(f)||V.test(f)||E.test(f))break;h+=`
`+d}!m&&!d.trim()&&(m=!0),c+=b+`
`,i=i.substring(b.length+1),f=x.slice(p)}}r.loose||(o?r.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(o=!0));let g=null,y;this.options.gfm&&(g=this.rules.other.listIsTask.exec(h),g&&(y=g[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:c,task:!!g,checked:y,loose:!1,text:h,tokens:[]}),r.raw+=c}let a=r.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let u=0;u<r.items.length;u++)if(this.lexer.state.top=!1,r.items[u].tokens=this.lexer.blockTokens(r.items[u].text,[]),!r.loose){let c=r.items[u].tokens.filter(f=>f.type==="space"),h=c.length>0&&c.some(f=>this.rules.other.anyLine.test(f.raw));r.loose=h}if(r.loose)for(let u=0;u<r.items.length;u++)r.items[u].loose=!0;return r}}html(i){let e=this.rules.block.html.exec(i);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(i){let e=this.rules.block.def.exec(i);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:s,title:r}}}table(i){var o;let e=this.rules.block.table.exec(i);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=je(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(o=e[3])!=null&&o.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],n={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===s.length){for(let a of s)this.rules.other.tableAlignRight.test(a)?n.align.push("right"):this.rules.other.tableAlignCenter.test(a)?n.align.push("center"):this.rules.other.tableAlignLeft.test(a)?n.align.push("left"):n.align.push(null);for(let a=0;a<t.length;a++)n.header.push({text:t[a],tokens:this.lexer.inline(t[a]),header:!0,align:n.align[a]});for(let a of r)n.rows.push(je(a,n.header.length).map((u,c)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:n.align[c]})));return n}}lheading(i){let e=this.rules.block.lheading.exec(i);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(i){let e=this.rules.block.paragraph.exec(i);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(i){let e=this.rules.block.text.exec(i);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(i){let e=this.rules.inline.escape.exec(i);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(i){let e=this.rules.inline.tag.exec(i);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(i){let e=this.rules.inline.link.exec(i);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let n=Y(t.slice(0,-1),"\\");if((t.length-n.length)%2===0)return}else{let n=Wt(e[2],"()");if(n===-2)return;if(n>-1){let o=(e[0].indexOf("!")===0?5:4)+e[1].length+n;e[2]=e[2].substring(0,n),e[0]=e[0].substring(0,o).trim(),e[3]=""}}let s=e[2],r="";if(this.options.pedantic){let n=this.rules.other.pedanticHrefTitle.exec(s);n&&(s=n[1],r=n[3])}else r=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?s=s.slice(1):s=s.slice(1,-1)),Ge(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(i,e){let t;if((t=this.rules.inline.reflink.exec(i))||(t=this.rules.inline.nolink.exec(i))){let s=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[s.toLowerCase()];if(!r){let n=t[0].charAt(0);return{type:"text",raw:n,text:n}}return Ge(t,r,t[0],this.lexer,this.rules)}}emStrong(i,e,t=""){let s=this.rules.inline.emStrongLDelim.exec(i);if(!(!s||s[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!t||this.rules.inline.punctuation.exec(t))){let r=[...s[0]].length-1,n,o,a=r,u=0,c=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*i.length+r);(s=c.exec(e))!=null;){if(n=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!n)continue;if(o=[...n].length,s[3]||s[4]){a+=o;continue}else if((s[5]||s[6])&&r%3&&!((r+o)%3)){u+=o;continue}if(a-=o,a>0)continue;o=Math.min(o,o+a+u);let h=[...s[0]][0].length,f=i.slice(0,r+s.index+h+o);if(Math.min(r,o)%2){let m=f.slice(1,-1);return{type:"em",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}let d=f.slice(2,-2);return{type:"strong",raw:f,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(i){let e=this.rules.inline.code.exec(i);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(t),r=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return s&&r&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(i){let e=this.rules.inline.br.exec(i);if(e)return{type:"br",raw:e[0]}}del(i){let e=this.rules.inline.del.exec(i);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(i){let e=this.rules.inline.autolink.exec(i);if(e){let t,s;return e[2]==="@"?(t=e[1],s="mailto:"+t):(t=e[1],s=t),{type:"link",raw:e[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}url(i){var t;let e;if(e=this.rules.inline.url.exec(i)){let s,r;if(e[2]==="@")s=e[0],r="mailto:"+s;else{let n;do n=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(n!==e[0]);s=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(i){let e=this.rules.inline.text.exec(i);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},G=class me{constructor(e){k(this,"tokens");k(this,"options");k(this,"state");k(this,"tokenizer");k(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||_,this.options.tokenizer=this.options.tokenizer||new ae,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:z,block:re.normal,inline:X.normal};this.options.pedantic?(t.block=re.pedantic,t.inline=X.pedantic):this.options.gfm&&(t.block=re.gfm,this.options.breaks?t.inline=X.breaks:t.inline=X.gfm),this.tokenizer.rules=t}static get rules(){return{block:re,inline:X}}static lex(e,t){return new me(t).lex(e)}static lexInline(e,t){return new me(t).inlineTokens(e)}lex(e){e=e.replace(z.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let s=this.inlineQueue[t];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){var r,n,o;for(this.options.pedantic&&(e=e.replace(z.tabCharGlobal,"    ").replace(z.spaceLine,""));e;){let a;if((n=(r=this.options.extensions)==null?void 0:r.block)!=null&&n.some(c=>(a=c.call({lexer:this},e,t))?(e=e.substring(a.raw.length),t.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);let c=t.at(-1);a.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.text,this.inlineQueue.at(-1).src=c.text):t.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title},t.push(a));continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),t.push(a);continue}let u=e;if((o=this.options.extensions)!=null&&o.startBlock){let c=1/0,h=e.slice(1),f;this.options.extensions.startBlock.forEach(d=>{f=d.call({lexer:this},h),typeof f=="number"&&f>=0&&(c=Math.min(c,f))}),c<1/0&&c>=0&&(u=e.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(u))){let c=t.at(-1);s&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(a),s=u.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+a.raw,c.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(a);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var a,u,c,h,f;let s=e,r=null;if(this.tokens.links){let d=Object.keys(this.tokens.links);if(d.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)d.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,r.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((u=(a=this.options.hooks)==null?void 0:a.emStrongMask)==null?void 0:u.call({lexer:this},s))??s;let n=!1,o="";for(;e;){n||(o=""),n=!1;let d;if((h=(c=this.options.extensions)==null?void 0:c.inline)!=null&&h.some(p=>(d=p.call({lexer:this},e,t))?(e=e.substring(d.raw.length),t.push(d),!0):!1))continue;if(d=this.tokenizer.escape(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.tag(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.link(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(d.raw.length);let p=t.at(-1);d.type==="text"&&(p==null?void 0:p.type)==="text"?(p.raw+=d.raw,p.text+=d.text):t.push(d);continue}if(d=this.tokenizer.emStrong(e,s,o)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.codespan(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.br(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.del(e)){e=e.substring(d.raw.length),t.push(d);continue}if(d=this.tokenizer.autolink(e)){e=e.substring(d.raw.length),t.push(d);continue}if(!this.state.inLink&&(d=this.tokenizer.url(e))){e=e.substring(d.raw.length),t.push(d);continue}let m=e;if((f=this.options.extensions)!=null&&f.startInline){let p=1/0,g=e.slice(1),y;this.options.extensions.startInline.forEach($=>{y=$.call({lexer:this},g),typeof y=="number"&&y>=0&&(p=Math.min(p,y))}),p<1/0&&p>=0&&(m=e.substring(0,p+1))}if(d=this.tokenizer.inlineText(m)){e=e.substring(d.raw.length),d.raw.slice(-1)!=="_"&&(o=d.raw.slice(-1)),n=!0;let p=t.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=d.raw,p.text+=d.text):t.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return t}},ue=class{constructor(i){k(this,"options");k(this,"parser");this.options=i||_}space(i){return""}code({text:i,lang:e,escaped:t}){var n;let s=(n=(e||"").match(z.notSpaceStart))==null?void 0:n[0],r=i.replace(z.endingNewline,"")+`
`;return s?'<pre><code class="language-'+N(s)+'">'+(t?r:N(r,!0))+`</code></pre>
`:"<pre><code>"+(t?r:N(r,!0))+`</code></pre>
`}blockquote({tokens:i}){return`<blockquote>
${this.parser.parse(i)}</blockquote>
`}html({text:i}){return i}def(i){return""}heading({tokens:i,depth:e}){return`<h${e}>${this.parser.parseInline(i)}</h${e}>
`}hr(i){return`<hr>
`}list(i){let e=i.ordered,t=i.start,s="";for(let o=0;o<i.items.length;o++){let a=i.items[o];s+=this.listitem(a)}let r=e?"ol":"ul",n=e&&t!==1?' start="'+t+'"':"";return"<"+r+n+`>
`+s+"</"+r+`>
`}listitem(i){var t;let e="";if(i.task){let s=this.checkbox({checked:!!i.checked});i.loose?((t=i.tokens[0])==null?void 0:t.type)==="paragraph"?(i.tokens[0].text=s+" "+i.tokens[0].text,i.tokens[0].tokens&&i.tokens[0].tokens.length>0&&i.tokens[0].tokens[0].type==="text"&&(i.tokens[0].tokens[0].text=s+" "+N(i.tokens[0].tokens[0].text),i.tokens[0].tokens[0].escaped=!0)):i.tokens.unshift({type:"text",raw:s+" ",text:s+" ",escaped:!0}):e+=s+" "}return e+=this.parser.parse(i.tokens,!!i.loose),`<li>${e}</li>
`}checkbox({checked:i}){return"<input "+(i?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:i}){return`<p>${this.parser.parseInline(i)}</p>
`}table(i){let e="",t="";for(let r=0;r<i.header.length;r++)t+=this.tablecell(i.header[r]);e+=this.tablerow({text:t});let s="";for(let r=0;r<i.rows.length;r++){let n=i.rows[r];t="";for(let o=0;o<n.length;o++)t+=this.tablecell(n[o]);s+=this.tablerow({text:t})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:i}){return`<tr>
${i}</tr>
`}tablecell(i){let e=this.parser.parseInline(i.tokens),t=i.header?"th":"td";return(i.align?`<${t} align="${i.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:i}){return`<strong>${this.parser.parseInline(i)}</strong>`}em({tokens:i}){return`<em>${this.parser.parseInline(i)}</em>`}codespan({text:i}){return`<code>${N(i,!0)}</code>`}br(i){return"<br>"}del({tokens:i}){return`<del>${this.parser.parseInline(i)}</del>`}link({href:i,title:e,tokens:t}){let s=this.parser.parseInline(t),r=De(i);if(r===null)return s;i=r;let n='<a href="'+i+'"';return e&&(n+=' title="'+N(e)+'"'),n+=">"+s+"</a>",n}image({href:i,title:e,text:t,tokens:s}){s&&(t=this.parser.parseInline(s,this.parser.textRenderer));let r=De(i);if(r===null)return N(t);i=r;let n=`<img src="${i}" alt="${t}"`;return e&&(n+=` title="${N(e)}"`),n+=">",n}text(i){return"tokens"in i&&i.tokens?this.parser.parseInline(i.tokens):"escaped"in i&&i.escaped?i.text:N(i.text)}},Re=class{strong({text:i}){return i}em({text:i}){return i}codespan({text:i}){return i}del({text:i}){return i}html({text:i}){return i}text({text:i}){return i}link({text:i}){return""+i}image({text:i}){return""+i}br(){return""}},B=class be{constructor(e){k(this,"options");k(this,"renderer");k(this,"textRenderer");this.options=e||_,this.options.renderer=this.options.renderer||new ue,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Re}static parse(e,t){return new be(t).parse(e)}static parseInline(e,t){return new be(t).parseInline(e)}parse(e,t=!0){var r,n;let s="";for(let o=0;o<e.length;o++){let a=e[o];if((n=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&n[a.type]){let c=a,h=this.options.extensions.renderers[c.type].call({parser:this},c);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(c.type)){s+=h||"";continue}}let u=a;switch(u.type){case"space":{s+=this.renderer.space(u);continue}case"hr":{s+=this.renderer.hr(u);continue}case"heading":{s+=this.renderer.heading(u);continue}case"code":{s+=this.renderer.code(u);continue}case"table":{s+=this.renderer.table(u);continue}case"blockquote":{s+=this.renderer.blockquote(u);continue}case"list":{s+=this.renderer.list(u);continue}case"html":{s+=this.renderer.html(u);continue}case"def":{s+=this.renderer.def(u);continue}case"paragraph":{s+=this.renderer.paragraph(u);continue}case"text":{let c=u,h=this.renderer.text(c);for(;o+1<e.length&&e[o+1].type==="text";)c=e[++o],h+=`
`+this.renderer.text(c);t?s+=this.renderer.paragraph({type:"paragraph",raw:h,text:h,tokens:[{type:"text",raw:h,text:h,escaped:!0}]}):s+=h;continue}default:{let c='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return s}parseInline(e,t=this.renderer){var r,n;let s="";for(let o=0;o<e.length;o++){let a=e[o];if((n=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&n[a.type]){let c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=c||"";continue}}let u=a;switch(u.type){case"escape":{s+=t.text(u);break}case"html":{s+=t.html(u);break}case"link":{s+=t.link(u);break}case"image":{s+=t.image(u);break}case"strong":{s+=t.strong(u);break}case"em":{s+=t.em(u);break}case"codespan":{s+=t.codespan(u);break}case"br":{s+=t.br(u);break}case"del":{s+=t.del(u);break}case"text":{s+=t.text(u);break}default:{let c='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return s}},ie,ee=(ie=class{constructor(i){k(this,"options");k(this,"block");this.options=i||_}preprocess(i){return i}postprocess(i){return i}processAllTokens(i){return i}emStrongMask(i){return i}provideLexer(){return this.block?G.lex:G.lexInline}provideParser(){return this.block?B.parse:B.parseInline}},k(ie,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),k(ie,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),ie),Zt=class{constructor(...i){k(this,"defaults",ke());k(this,"options",this.setOptions);k(this,"parse",this.parseMarkdown(!0));k(this,"parseInline",this.parseMarkdown(!1));k(this,"Parser",B);k(this,"Renderer",ue);k(this,"TextRenderer",Re);k(this,"Lexer",G);k(this,"Tokenizer",ae);k(this,"Hooks",ee);this.use(...i)}walkTokens(i,e){var s,r;let t=[];for(let n of i)switch(t=t.concat(e.call(this,n)),n.type){case"table":{let o=n;for(let a of o.header)t=t.concat(this.walkTokens(a.tokens,e));for(let a of o.rows)for(let u of a)t=t.concat(this.walkTokens(u.tokens,e));break}case"list":{let o=n;t=t.concat(this.walkTokens(o.items,e));break}default:{let o=n;(r=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&r[o.type]?this.defaults.extensions.childTokens[o.type].forEach(a=>{let u=o[a].flat(1/0);t=t.concat(this.walkTokens(u,e))}):o.tokens&&(t=t.concat(this.walkTokens(o.tokens,e)))}}return t}use(...i){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return i.forEach(t=>{let s={...t};if(s.async=this.defaults.async||s.async||!1,t.extensions&&(t.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let n=e.renderers[r.name];n?e.renderers[r.name]=function(...o){let a=r.renderer.apply(this,o);return a===!1&&(a=n.apply(this,o)),a}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let n=e[r.level];n?n.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),s.extensions=e),t.renderer){let r=this.defaults.renderer||new ue(this.defaults);for(let n in t.renderer){if(!(n in r))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;let o=n,a=t.renderer[o],u=r[o];r[o]=(...c)=>{let h=a.apply(r,c);return h===!1&&(h=u.apply(r,c)),h||""}}s.renderer=r}if(t.tokenizer){let r=this.defaults.tokenizer||new ae(this.defaults);for(let n in t.tokenizer){if(!(n in r))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;let o=n,a=t.tokenizer[o],u=r[o];r[o]=(...c)=>{let h=a.apply(r,c);return h===!1&&(h=u.apply(r,c)),h}}s.tokenizer=r}if(t.hooks){let r=this.defaults.hooks||new ee;for(let n in t.hooks){if(!(n in r))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;let o=n,a=t.hooks[o],u=r[o];ee.passThroughHooks.has(n)?r[o]=c=>{if(this.defaults.async&&ee.passThroughHooksRespectAsync.has(n))return Promise.resolve(a.call(r,c)).then(f=>u.call(r,f));let h=a.call(r,c);return u.call(r,h)}:r[o]=(...c)=>{let h=a.apply(r,c);return h===!1&&(h=u.apply(r,c)),h}}s.hooks=r}if(t.walkTokens){let r=this.defaults.walkTokens,n=t.walkTokens;s.walkTokens=function(o){let a=[];return a.push(n.call(this,o)),r&&(a=a.concat(r.call(this,o))),a}}this.defaults={...this.defaults,...s}}),this}setOptions(i){return this.defaults={...this.defaults,...i},this}lexer(i,e){return G.lex(i,e??this.defaults)}parser(i,e){return B.parse(i,e??this.defaults)}parseMarkdown(i){return(e,t)=>{let s={...t},r={...this.defaults,...s},n=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&s.async===!1)return n(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return n(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return n(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=i);let o=r.hooks?r.hooks.provideLexer():i?G.lex:G.lexInline,a=r.hooks?r.hooks.provideParser():i?B.parse:B.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(e):e).then(u=>o(u,r)).then(u=>r.hooks?r.hooks.processAllTokens(u):u).then(u=>r.walkTokens?Promise.all(this.walkTokens(u,r.walkTokens)).then(()=>u):u).then(u=>a(u,r)).then(u=>r.hooks?r.hooks.postprocess(u):u).catch(n);try{r.hooks&&(e=r.hooks.preprocess(e));let u=o(e,r);r.hooks&&(u=r.hooks.processAllTokens(u)),r.walkTokens&&this.walkTokens(u,r.walkTokens);let c=a(u,r);return r.hooks&&(c=r.hooks.postprocess(c)),c}catch(u){return n(u)}}}onError(i,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,i){let s="<p>An error occurred:</p><pre>"+N(t.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(t);throw t}}},W=new Zt;function P(i,e){return W.parse(i,e)}P.options=P.setOptions=function(i){return W.setOptions(i),P.defaults=W.defaults,Ve(P.defaults),P};P.getDefaults=ke;P.defaults=_;P.use=function(...i){return W.use(...i),P.defaults=W.defaults,Ve(P.defaults),P};P.walkTokens=function(i,e){return W.walkTokens(i,e)};P.parseInline=W.parseInline;P.Parser=B;P.parser=B.parse;P.Renderer=ue;P.TextRenderer=Re;P.Lexer=G;P.lexer=G.lex;P.Tokenizer=ae;P.Hooks=ee;P.parse=P;P.options;P.setOptions;P.use;P.walkTokens;P.parseInline;B.parse;G.lex;class Ce{constructor(e,t){k(this,"config");k(this,"modelId");this.config=e,this.modelId=t}async fetchWithTimeout(e,t,s=3e5){const r=new AbortController,n=setTimeout(()=>r.abort(),s);try{return await fetch(e,{...t,signal:r.signal})}finally{clearTimeout(n)}}}class Qt{static convertAttachments(e){return e.map(t=>t.type==="image"&&["image/png","image/jpeg","image/jpg","image/webp","image/gif"].includes(t.mimeType)?{type:"image_url",image_url:{url:`data:${t.mimeType};base64,${t.data}`}}:null).filter(t=>t!==null)}static isSupported(e){return e.type!=="image"?!1:["image/png","image/jpeg","image/jpg","image/webp","image/gif"].includes(e.mimeType)}static getSupportedTypes(){return["image/png","image/jpeg","image/jpg","image/webp","image/gif"]}}class tt{constructor(){k(this,"buffer","");k(this,"inThinkTag",!1);k(this,"thinkTagContent","")}reset(){this.buffer="",this.inThinkTag=!1,this.thinkTagContent=""}filterChunk(e){this.buffer+=e;let t="";for(;this.buffer.length>0;)if(this.inThinkTag){const s=this.buffer.indexOf("</think>");if(s===-1){this.buffer.length>8&&(this.thinkTagContent+=this.buffer.slice(0,-8),this.buffer=this.buffer.slice(-8));break}else this.thinkTagContent+=this.buffer.slice(0,s),this.buffer=this.buffer.slice(s+8),this.inThinkTag=!1,this.thinkTagContent=""}else{const s=this.buffer.indexOf("<think>");if(s===-1){this.buffer.length>7&&(t+=this.buffer.slice(0,-7),this.buffer=this.buffer.slice(-7));break}else t+=this.buffer.slice(0,s),this.buffer=this.buffer.slice(s+7),this.inThinkTag=!0,this.thinkTagContent=""}return t}finalize(){const e=this.buffer;return this.reset(),e}static removeThinkTags(e){return e.replace(/<think>[\s\S]*?<\/think>/g,"")}}class q{static cleanResponse(e){try{let t=e.replace(/<ASSESSMENT>[\s\S]*?<\/ASSESSMENT>/gi,"").trim();const s=t.indexOf("<ASSESSMENT>");if(s!==-1&&(t=t.substring(0,s).trim()),t.includes("ASSESSMENT")||t.includes("CONTEXT:")||t.includes("DECISION:")){const n=[/<ASSE[^>]*$/i,/<\/ASSE[^>]*$/i,/\n\n<ASSE/i,/\nCONTEXT:/i,/\nTASK:/i,/\nFORMAT:/i,/\nQUALITY:/i,/\nTURN_COUNT:/i,/\nDECISION:/i,/\nCONFIDENCE:/i];for(const o of n){const a=t.search(o);if(a!==-1){t=t.substring(0,a).trim();break}}}return t}catch{return e}}static cleanThinkTags(e){return e&&tt.removeThinkTags(e)}}class Be extends Ce{async callAPI(e,t){var u,c,h,f,d,m;if(!this.config.baseUrl)throw new Error("API URL 未配置");let s=this.config.baseUrl.trim();s.includes("/chat/completions")||(s.includes("/v1")?s=s.replace(/\/+$/,"")+"/chat/completions":s=s.replace(/\/+$/,"")+"/v1/chat/completions");const r=this.modelId,o=r.includes("gpt-5")||r.includes("o1")||r.includes("thinking")?6e5:3e5,a=await this.fetchWithTimeout(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},body:JSON.stringify({model:r,messages:e.map(p=>{var g;if(this.hasMultimodalContent(p)){const y=this.convertToMultimodalContent(p);return{role:p.role,content:y}}else return{role:p.role,content:typeof p.content=="string"?p.content:((g=p.content[0])==null?void 0:g.text)||""}}),temperature:.7,max_tokens:6e4,...t&&{stream:!0}})},o);if(!a.ok){const p=await a.json().catch(()=>({})),g=new Error(`OpenAI API error: ${a.status} ${a.statusText}`);throw g.error=p,g.status=a.status,g}if(t)return a.body;{const p=await a.json();let g;if(p.choices&&((c=(u=p.choices[0])==null?void 0:u.message)!=null&&c.content))g=p.choices[0].message.content;else if(p.candidates&&((f=(h=p.candidates[0])==null?void 0:h.content)!=null&&f.parts)){const y=p.candidates[0].content.parts;for(const $ of y)if($.text&&!$.thought){g=$.text;break}}else p.content&&typeof p.content=="string"?g=p.content:p.text&&typeof p.text=="string"&&(g=p.text);if(!g||g.trim()==="")throw new Error("API返回空内容或无法解析响应格式");return g=q.cleanResponse(g),g=q.cleanThinkTags(g),{content:g,finishReason:(m=(d=p.choices)==null?void 0:d[0])==null?void 0:m.finish_reason}}}parseStreamChunk(e){var t,s,r,n,o,a,u,c,h;if(!e.trim()||e.trim()==="[DONE]")return{content:"",done:!0};if(e===": OPENROUTER PROCESSING"||e.startsWith(": ")&&e.toUpperCase().includes("PROCESSING"))return null;try{const f=JSON.parse(e);let d;if((r=(s=(t=f.choices)==null?void 0:t[0])==null?void 0:s.delta)!=null&&r.content)d=f.choices[0].delta.content;else if((a=(o=(n=f.candidates)==null?void 0:n[0])==null?void 0:o.content)!=null&&a.parts){const g=f.candidates[0].content.parts;for(const y of g)if(y.text&&!y.thought){d=y.text;break}}else(u=f.delta)!=null&&u.text?d=f.delta.text:f.text&&(d=f.text);const p=!!(((h=(c=f.choices)==null?void 0:c[0])==null?void 0:h.finish_reason)||f.done);return{content:d||"",done:p}}catch{return null}}hasMultimodalContent(e){return!!(e.attachments&&e.attachments.length>0)}convertToMultimodalContent(e){const t=[];if(typeof e.content=="string"&&e.content.trim()&&t.push({type:"text",text:e.content}),e.attachments&&e.attachments.length>0){const s=Qt.convertAttachments(e.attachments);t.push(...s)}return t}}class Ht{static convertAttachments(e){return e.map(t=>t.type==="image"?{type:"image",source:{type:"base64",media_type:t.mimeType,data:t.data}}:t.type==="document"&&["application/pdf","text/plain","text/markdown","application/json","text/html","text/csv"].includes(t.mimeType)?{type:"image",source:{type:"base64",media_type:t.mimeType,data:t.data}}:null).filter(t=>t!==null)}static isSupported(e){return e.type==="image"?!0:e.type==="document"?["application/pdf","text/plain","text/markdown","application/json","text/html","text/csv"].includes(e.mimeType):!1}static getSupportedTypes(){return["image/png","image/jpeg","image/jpg","image/webp","image/gif","application/pdf","text/plain","text/markdown","application/json","text/html","text/csv"]}}class Jt extends Ce{async callAPI(e,t){var h;const s=this.extractSystemMessageText(e),r=e.filter(f=>f.role!=="system");if(!this.config.baseUrl)throw new Error("API URL 未配置");let n=this.config.baseUrl.trim();n.includes("/v1/messages")||(n=n.replace(/\/+$/,"")+"/v1/messages");const o=this.modelId,u=o.includes("claude-3")||o.includes("thinking")||o.includes("sonnet")?6e5:3e5,c=await this.fetchWithTimeout(n,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.config.apiKey,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:o,max_tokens:6e4,system:s,messages:r.map(f=>{var d;return{role:f.role==="assistant"?"assistant":"user",content:this.hasMultimodalContent(f)?this.convertToMultimodalContent(f):typeof f.content=="string"?f.content:Array.isArray(f.content)?((d=f.content[0])==null?void 0:d.text)||"":String(f.content)}}),...t&&{stream:!0}})},u);if(!c.ok){const f=await c.json().catch(()=>({})),d=new Error(`Anthropic API error: ${c.status} ${c.statusText}`);throw d.error=f,d.status=c.status,d}if(t)return c.body;{const f=await c.json(),d=(h=f.content[0])==null?void 0:h.text;if(!d||d.trim()==="")throw new Error("API返回空内容");return{content:q.cleanThinkTags(d),finishReason:f.stop_reason}}}parseStreamChunk(e){var t;if(!e.trim())return null;try{const s=JSON.parse(e);if(s.type==="content_block_delta"){const r=(t=s.delta)==null?void 0:t.text;if(r)return{content:r,done:!1}}else if(s.type==="message_stop")return{content:"",done:!0};return null}catch{return null}}extractSystemMessageText(e){const t=e.find(s=>s.role==="system");return t?typeof t.content=="string"?t.content:Array.isArray(t.content)?t.content.map(s=>s.text||"").join(" "):"":""}hasMultimodalContent(e){return!!(e.attachments&&e.attachments.length>0)}convertToMultimodalContent(e){const t=[];if(typeof e.content=="string"&&e.content.trim()&&t.push({type:"text",text:e.content}),e.attachments&&e.attachments.length>0){const s=Ht.convertAttachments(e.attachments);t.push(...s)}return t}}class qe{static convertAttachments(e){return e.map(t=>t.type==="image"?{inline_data:{mime_type:t.mimeType,data:t.data}}:t.type==="document"?["text/plain","text/html","text/css","text/javascript","application/json","text/markdown","application/pdf","text/csv","text/xml","application/xml","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/rtf"].includes(t.mimeType)?{inline_data:{mime_type:t.mimeType,data:t.data}}:null:t.type==="audio"?["audio/wav","audio/mp3","audio/mpeg","audio/aac","audio/ogg","audio/flac"].includes(t.mimeType)?{inline_data:{mime_type:t.mimeType,data:t.data}}:null:t.type==="video"&&["video/mp4","video/mpeg","video/mov","video/avi","video/x-flv","video/mpg","video/webm","video/wmv"].includes(t.mimeType)?{inline_data:{mime_type:t.mimeType,data:t.data}}:null).filter(Boolean)}static isSupported(e){return e.type==="image"?!0:e.type==="document"?["text/plain","text/html","text/css","text/javascript","application/json","text/markdown","application/pdf","text/csv","text/xml","application/xml","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/rtf"].includes(e.mimeType):e.type==="audio"?["audio/wav","audio/mp3","audio/mpeg","audio/aac","audio/ogg","audio/flac"].includes(e.mimeType):e.type==="video"?["video/mp4","video/mpeg","video/mov","video/avi","video/x-flv","video/mpg","video/webm","video/wmv"].includes(e.mimeType):!1}static getSupportedTypes(){return["image/png","image/jpeg","image/jpg","image/webp","image/gif","image/bmp","image/tiff","image/svg+xml","image/heic","text/plain","text/html","text/css","text/javascript","application/json","text/markdown","application/pdf","text/csv","text/xml","application/xml","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/rtf","audio/wav","audio/mp3","audio/mpeg","audio/aac","audio/ogg","audio/flac","video/mp4","video/mpeg","video/mov","video/avi","video/x-flv","video/mpg","video/webm","video/wmv"]}}class Xt extends Ce{async callAPI(e,t){var f,d;const s=this.extractSystemMessageText(e),o={contents:e.filter(m=>m.role!=="system").map(m=>{var g;const p=m.role==="assistant"?"model":"user";if(this.hasMultimodalContent(m)){const y=this.convertToMultimodalContent(m);return{role:p,parts:y}}else{const y=typeof m.content=="string"?m.content:((g=m.content[0])==null?void 0:g.text)||"";return{role:p,parts:[{text:y}]}}}),generationConfig:{temperature:.7}};if(s&&(o.system_instruction={parts:[{text:s}]}),!this.config.baseUrl)throw new Error("API URL 未配置");let a=this.config.baseUrl.trim();a.endsWith("/v1beta")||(a.includes("/models/")&&(a=a.split("/models/")[0]),a.endsWith("/v1beta")||(a=a.replace(/\/+$/,"")+"/v1beta"));const u=this.modelId;if(t){a=`${a}/models/${u}:streamGenerateContent`;const m=new URL(a);m.searchParams.set("alt","sse"),a=m.toString()}else a=`${a}/models/${u}:generateContent`;const h=await this.fetchWithTimeout(a,{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-key":this.config.apiKey},body:JSON.stringify(o)},3e5);if(!h.ok){const m=await h.json().catch(()=>({})),p=new Error(`Google Gemini API error: ${h.status} ${h.statusText}`);throw p.error=m,p.status=h.status,p}if(t)return h.body;{const p=(f=(await h.json()).candidates)==null?void 0:f[0];if(!((d=p==null?void 0:p.content)!=null&&d.parts))throw new Error("API返回数据结构异常");let g="";for(const $ of p.content.parts)if($.text&&!$.thought){g=$.text;break}if(!g||g.trim()==="")throw new Error("API返回空内容");return{content:q.cleanThinkTags(g),finishReason:p.finishReason}}}parseStreamChunk(e){var t,s;try{const n=(t=JSON.parse(e).candidates)==null?void 0:t[0];if((s=n==null?void 0:n.content)!=null&&s.parts){for(const o of n.content.parts)if(o.text&&!o.thought)return{content:o.text,done:!1}}return n!=null&&n.finishReason?{content:"",done:!0}:null}catch{return null}}extractSystemMessageText(e){const t=e.find(s=>s.role==="system");return t?typeof t.content=="string"?t.content:Array.isArray(t.content)?t.content.map(s=>s.text||"").join(" "):"":""}hasMultimodalContent(e){return!!(e.attachments&&e.attachments.length>0)}convertToMultimodalContent(e){const t=[];if(typeof e.content=="string"&&e.content.trim()&&t.push({text:e.content}),e.attachments&&e.attachments.length>0){const s=qe.convertAttachments(e.attachments);t.push(...s);const r=e.attachments.length;if(s.length<r){const o=e.attachments.filter(a=>!qe.isSupported(a));if(o.length>0){const u=`[用户上传了以下附件，但当前无法直接处理: ${o.map(c=>`${c.name} (${c.type}, ${(c.size/1024).toFixed(1)}KB)`).join(", ")}。用户询问关于这些附件的问题。]`;t.push({text:u})}}}return t}}class Yt{isValidSSELine(e){if(!e||typeof e!="string")return!1;const t=e.trim();if(!t.startsWith("data: "))return!1;const s=t.slice(6).trim();return!s||s==="[DONE]"?!0:!(s===": OPENROUTER PROCESSING"||s.startsWith(": ")&&s.toUpperCase().includes("PROCESSING"))}parseDataFromLine(e){if(!this.isValidSSELine(e))return null;const t=e.slice(6).trim();return!t||t==="[DONE]"?null:t}}class es{constructor(){k(this,"sseParser");k(this,"streamFilter");this.sseParser=new Yt,this.streamFilter=new tt}reset(){this.streamFilter.reset()}async*processStream(e,t){const s=e.getReader(),r=new TextDecoder;try{for(;;){const{done:n,value:o}=await s.read();if(n){const c=this.streamFilter.finalize();c&&(yield c);break}const u=r.decode(o,{stream:!0}).split(`
`);for(const c of u){const h=this.sseParser.parseDataFromLine(c);if(!h)continue;const f=t(h);if(!f||!f.content)continue;const d=this.streamFilter.filterChunk(f.content);if(d&&(yield d),f.done){const m=this.streamFilter.finalize();m&&(yield m);return}}}}finally{s.releaseLock()}}}class ts{parseAPIError(e,t){try{let s="",r="";e.message&&typeof e.message=="string"?s=e.message:e.error&&e.error.message?(s=e.error.message,r=e.error.code||e.error.type||""):typeof e=="string"?s=e:s=JSON.stringify(e);const n=/Unsupported MIME type: ([^(]+)/i,o=s.match(n);return o?this.parseMimeTypeError(o[1].trim(),t):this.isAttachmentError(s)?"当前模型不支持附件功能。请移除附件或切换到支持多模态的模型（如GPT-4 Vision、Claude 3.5+或Gemini）。":this.isModelError(s)?"模型不可用或配置错误。请检查模型名称和API配置。":this.isAuthError(s,r)?"API密钥无效或未授权。请检查您的API密钥配置。":this.isRateLimitError(s,r)?"API调用频率过高或配额已用完。请稍后重试或检查您的API账户状态。":this.isNetworkError(s)?"网络连接错误。请检查网络连接后重试。":`API请求失败：${s}`}catch{return"API请求失败，请检查网络连接和配置后重试。"}}parseMimeTypeError(e,t){const s=this.getFileTypeHint(e),r=this.getModelSuggestion(t);return`${s}格式不受当前模型支持。

${r}，或移除附件后重新发送。`}getFileTypeHint(e){return e.startsWith("application/vnd.openxmlformats-officedocument")?e.includes("wordprocessingml")?"Word文档(.docx)":e.includes("spreadsheetml")?"Excel表格(.xlsx)":e.includes("presentationml")?"PowerPoint演示文稿(.pptx)":"Office文档":e.startsWith("application/msword")?"Word文档(.doc)":e.startsWith("application/vnd.ms-excel")?"Excel表格(.xls)":e.startsWith("application/vnd.ms-powerpoint")?"PowerPoint演示文稿(.ppt)":e.startsWith("application/pdf")?"PDF文档":e.startsWith("text/")?"文本文件":e.startsWith("image/")?"图片文件":e.startsWith("audio/")?"音频文件":e.startsWith("video/")?"视频文件":"该文件"}getModelSuggestion(e){switch(e){case"openai":return"当前OpenAI模型主要支持图片格式。建议切换到支持更多文件类型的模型（如Gemini）";case"anthropic":return"当前Claude模型支持图片和PDF文档格式。建议切换到支持更多文件类型的模型（如Gemini），或使用支持的格式";case"google":return"当前Gemini模型不支持此文件格式。建议使用支持的格式（图片、PDF、Office文档等）";default:return"当前模型不支持此文件格式。建议切换到支持多模态的模型"}}isAttachmentError(e){const t=e.toLowerCase();return t.includes("multimodal")||t.includes("attachment")||t.includes("file")||t.includes("image")}isModelError(e){const t=e.toLowerCase();return t.includes("model")&&(t.includes("not found")||t.includes("invalid"))}isAuthError(e,t){const s=e.toLowerCase();return s.includes("api key")||s.includes("unauthorized")||s.includes("authentication")||t==="401"}isRateLimitError(e,t){const s=e.toLowerCase();return s.includes("quota")||s.includes("limit")||s.includes("rate")||t==="429"}isNetworkError(e){const t=e.toLowerCase();return t.includes("network")||t.includes("timeout")||t.includes("connection")}}class st{static parseError(e,t){return this.errorParser.parseAPIError(e,t)}static handleNetworkError(e){return e.name==="AbortError"?"请求已被取消":e.name==="TimeoutError"?"请求超时，请检查网络连接后重试":"网络连接错误，请检查网络连接后重试"}static isRetriableError(e){var r,n;const t=((r=e==null?void 0:e.message)==null?void 0:r.toLowerCase())||"",s=((n=e==null?void 0:e.error)==null?void 0:n.code)||(e==null?void 0:e.code)||"";return!!(t.includes("network")||t.includes("timeout")||t.includes("connection")||s==="429"||t.includes("rate limit")||s>="500"&&s<"600")}}k(st,"errorParser",new ts);class ss{static async fetchWithTimeout(e,t,s=3e4){const r=new AbortController,n=setTimeout(()=>r.abort(),s);try{return await fetch(e,{...t,signal:r.signal})}finally{clearTimeout(n)}}static async getModels(e,t){switch(t||e.type){case"openai":return await this.getOpenAIModels(e);case"anthropic":return await this.getAnthropicModels();case"google":return await this.getGeminiModels(e);case"custom":return await this.getCustomProviderModels(e,t);default:return await this.getOpenAIModels(e)}}static async getOpenAIModels(e){if(!e.baseUrl)throw new Error("API URL 未配置");const t=this.buildOpenAIModelsUrl(e.baseUrl),s=await this.fetchWithTimeout(t,{method:"GET",headers:{Authorization:`Bearer ${e.apiKey}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`OpenAI Models API error: ${s.status} ${s.statusText}`);const r=await s.json();if(r.data&&Array.isArray(r.data))return r.data.map(n=>n.id).filter(n=>n&&typeof n=="string").sort();throw new Error("OpenAI API返回的模型列表格式不正确")}static async getGeminiModels(e){if(!e.baseUrl)throw new Error("API URL 未配置");const t=this.buildGeminiModelsUrl(e.baseUrl),s=new URL(t);s.searchParams.set("key",e.apiKey);const r=await this.fetchWithTimeout(s.toString(),{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Gemini Models API error: ${r.status} ${r.statusText}`);const n=await r.json();if(n.models&&Array.isArray(n.models))return n.models.map(o=>o.name&&typeof o.name=="string"?o.name.replace(/^models\//,""):o.id||o.name).filter(o=>o&&typeof o=="string").sort();throw new Error("Gemini API返回的模型列表格式不正确")}static async getAnthropicModels(){return["claude-3-5-sonnet-20241022","claude-3-5-haiku-20241022","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307"].sort()}static async getCustomProviderModels(e,t){var r;if(t)switch(t){case"openai":return await this.getOpenAIModels(e);case"anthropic":return await this.getAnthropicModels();case"google":return await this.getGeminiModels(e)}const s=((r=e.baseUrl)==null?void 0:r.toLowerCase())||"";if(s.includes("googleapis.com")||s.includes("generativelanguage")||s.includes("/v1beta")||s.includes("gemini"))return await this.getGeminiModels(e);if(s.includes("anthropic.com")||s.includes("claude"))return await this.getAnthropicModels();try{return await this.getOpenAIModels(e)}catch{try{return await this.getGeminiModels(e)}catch{return await this.getGenericModels(e)}}}static async getGenericModels(e){if(!e.baseUrl)throw new Error("API URL 未配置");let t=e.baseUrl.trim();t.includes("/models")||(t.includes("/v1")?t=t.replace(/\/+$/,"")+"/models":t=t.replace(/\/+$/,"")+"/v1/models");const s=await this.fetchWithTimeout(t,{method:"GET",headers:{Authorization:`Bearer ${e.apiKey}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Models API error: ${s.status} ${s.statusText}`);const r=await s.json();let n=[];if(r.data&&Array.isArray(r.data)?n=r.data.map(o=>o.id).filter(o=>o&&typeof o=="string"):r.models&&Array.isArray(r.models)?n=r.models.map(o=>o.name&&typeof o.name=="string"?o.name.replace(/^models\//,""):o.id||o.name).filter(o=>o&&typeof o=="string"):Array.isArray(r)&&(n=r.map(o=>typeof o=="string"?o:o.id?o.id:o.name?o.name.replace(/^models\//,""):null).filter(o=>o&&typeof o=="string")),n.length>0)return n.sort();throw new Error("无效的模型列表响应格式")}static buildOpenAIModelsUrl(e){if(!e)throw new Error("API URL 未配置");let t=e.trim();return t.endsWith("/models")||t.includes("/models?")||t.includes("/models/")?t:t.includes("/v1")?t.replace(/\/+$/,"")+"/models":t.replace(/\/+$/,"")+"/v1/models"}static buildGeminiModelsUrl(e){if(!e)throw new Error("API URL 未配置");let t=e.trim();return t.includes("/models")?t:t.includes("/v1beta")?t.replace(/\/+$/,"")+"/models":t.replace(/\/+$/,"")+"/v1beta/models"}}const K=class K{constructor(){k(this,"providers",new Map);k(this,"streamProcessor");k(this,"onStreamUpdate");this.streamProcessor=new es}static getInstance(){return K.instance||(K.instance=new K),K.instance}getProvider(e,t){const s=`${e.type}-${e.baseUrl}-${t}`;if(this.providers.has(s))return this.providers.get(s);const r=e.models.find(a=>a.id===t),n=(r==null?void 0:r.apiType)||e.type;let o;switch(n){case"openai":o=new Be(e,t);break;case"anthropic":o=new Jt(e,t);break;case"google":o=new Xt(e,t);break;default:o=new Be(e,t)}return this.providers.set(s,o),o}convertMessagesToAI(e){return e.map(t=>"role"in t?{role:t.role,content:t.content,attachments:t.attachments}:{role:t.type==="ai"?"assistant":"user",content:t.content,attachments:t.attachments})}async callAI(e,t,s,r=!1,n){const o=t.models.find(u=>u.id===s),a=(o==null?void 0:o.apiType)||t.type;try{const u=this.convertMessagesToAI(e),c=this.getProvider(t,s);if(r)return await this.callWithStream(c,u,n);{const h=await c.callAPI(u,!1);if(typeof h!="object"||!("content"in h))throw new Error("Expected AIResponse object");let f=h.content;return f=q.cleanResponse(f),f=q.cleanThinkTags(f),f}}catch(u){const c=st.parseError(u,a);throw new Error(c)}}async callWithStream(e,t,s){const r=s||this.onStreamUpdate,n=!!this.onStreamUpdate;try{const o=await e.callAPI(t,!0);if(typeof o=="string"||!("getReader"in o))throw new Error("Expected ReadableStream for streaming");let a="";this.streamProcessor.reset();const u=e.parseStreamChunk.bind(e);for await(const h of this.streamProcessor.processStream(o,u))a+=h,r&&r(h);if(!a||a.trim()==="")throw new Error("API返回空内容");let c=q.cleanResponse(a);return c=q.cleanThinkTags(c),c}finally{n&&this.clearStreamUpdateCallback()}}setStreamUpdateCallback(e){this.onStreamUpdate=e}clearStreamUpdateCallback(){this.onStreamUpdate=void 0}async getAvailableModels(e,t){return await ss.getModels(e,t)}async testConnection(e,t){try{const s=[{type:"user",content:"test",timestamp:new Date().toISOString()}];return await this.callAI(s,e,t,!1),!0}catch{return!1}}};k(K,"instance");let xe=K;function er(){const i=Z(),e=ye(),t=I(null),s=I({}),r=I({}),n=new Map,o=m=>{switch(m.testStatus){case"testing":return"点击停止测试";case"success":return"重新测试";case"failed":return"重新测试";default:return"测试模型连接和能力"}},a=m=>{const p=s.value[m.id];return p!=null&&p.isTesting&&!p.isAborted?`批量测试中... (${p.currentModelIndex}/${p.totalModels}) 点击中断`:p!=null&&p.isTesting&&p.isAborted?"正在中断测试...":m.models.length===0?"没有可测试的模型":"批量测试模型"},u=(m,p)=>{const g=`${m}:${p}`,y=n.get(g);y&&(y.abort(),n.delete(g)),i.updateModelTestStatus(m,p,"untested"),e.warning(`已停止模型 ${p} 的测试`),i.saveSettings()},c=async(m,p)=>{const g=i.providers.find(C=>C.id===m);if(!g){e.error("未找到提供商配置");return}if(!g.apiKey){e.warning("请先配置API密钥");return}const y=new AbortController,$=`${m}:${p}`;n.set($,y);const E=g.models.find(C=>C.id===p);E&&(E.testStatus="untested",E.capabilities=void 0,E.lastTested=void 0),i.updateModelTestStatus(m,p,"testing");try{const{CapabilityDetector:C}=await Ie(async()=>{const{CapabilityDetector:R}=await import("./capabilityDetector-BSvar9Da.js");return{CapabilityDetector:R}},__vite__mapDeps([0,1,2]));await C.getInstance().detectCapabilitiesWithCallback(g,p,(R,b,x)=>{y.signal.aborted||(R?(i.updateModelConnectionStatus(m,p,!0),i.updateModelTestStatus(m,p,"success"),e.success(`模型 ${p} 连接成功！(${b}ms) 正在后台检测思考能力...`)):(i.updateModelConnectionStatus(m,p,!1,x),i.updateModelTestStatus(m,p,"failed"),e.error(`模型 ${p} 连接失败：${x||"未知错误"}`)),i.saveSettings())},R=>{if(!y.signal.aborted){if(i.updateModelCapabilities(m,p,R),R.reasoning){const b=i.getReasoningTypeDescription(R.reasoningType);e.success(`🧠 模型 ${p} 思考能力检测完成：支持${b}`)}i.saveSettings(),n.delete($)}},!0,y)}catch(C){if(C instanceof Error&&C.name==="AbortError")return;i.updateModelTestStatus(m,p,"failed"),e.error(`模型 ${p} 测试出错：${C.message}`),i.saveSettings()}finally{n.delete($)}},h=async(m,p,g)=>{g==="testing"?u(m,p):c(m,p)},f=async m=>{var C,V;const p=m.id,g=s.value[p];if(g!=null&&g.isTesting){d(p);return}if(!m.apiKey){e.warning("请先配置API密钥");return}const y=m.models.filter(R=>R.enabled);if(y.length===0){e.warning("请先启用至少一个模型");return}s.value[p]={isTesting:!0,currentModelIndex:0,totalModels:y.length,isAborted:!1},r.value[p]=new AbortController,t.value=p;let $=0,E=0;try{e.success(`开始批量测试 ${y.length} 个模型...`);for(let b=0;b<y.length;b++){const x=s.value[p];if(x!=null&&x.isAborted){e.warning("批量测试已中断");break}const S=y[b];s.value[p].currentModelIndex=b+1;try{if((C=r.value[p])!=null&&C.signal.aborted)break;S.testStatus="untested",S.capabilities=void 0,S.lastTested=void 0,i.updateModelTestStatus(p,S.id,"testing");const{CapabilityDetector:D}=await Ie(async()=>{const{CapabilityDetector:H}=await import("./capabilityDetector-BSvar9Da.js");return{CapabilityDetector:H}},__vite__mapDeps([0,1,2]));if(await D.getInstance().detectCapabilitiesWithCallback(m,S.id,(H,Qn,nt)=>{H?(i.updateModelConnectionStatus(p,S.id,!0),i.updateModelTestStatus(p,S.id,"success"),$++):(i.updateModelConnectionStatus(p,S.id,!1,nt),i.updateModelTestStatus(p,S.id,"failed"),E++),i.saveSettings()},H=>{i.updateModelCapabilities(p,S.id,H),i.saveSettings()},!0,r.value[p]),(V=r.value[p])!=null&&V.signal.aborted)break}catch{i.updateModelTestStatus(p,S.id,"failed"),E++,i.saveSettings()}}const R=s.value[p];R!=null&&R.isAborted||e.success(`批量测试完成！成功: ${$}, 失败: ${E}`)}catch(R){e.error(`批量测试出错：${R.message}`)}finally{const R=i.providers.find(b=>b.id===p);R&&(R.models.forEach(b=>{var x,S;b.testStatus==="testing"&&(((S=(x=b.capabilities)==null?void 0:x.testResult)==null?void 0:S.connected)!==void 0?b.testStatus=b.capabilities.testResult.connected?"success":"failed":b.testStatus="untested")}),i.saveSettings()),delete s.value[p],delete r.value[p],t.value===p&&(t.value=null)}},d=m=>{var g;const p=s.value[m];p!=null&&p.isTesting&&(p.isAborted=!0,(g=r.value[m])==null||g.abort(),e.warning("正在中断批量测试..."),setTimeout(()=>{const y=i.providers.find($=>$.id===m);y&&(y.models.forEach($=>{var E,C;$.testStatus==="testing"&&(((C=(E=$.capabilities)==null?void 0:E.testResult)==null?void 0:C.connected)!==void 0?$.testStatus=$.capabilities.testResult.connected?"success":"failed":$.testStatus="untested")}),i.saveSettings()),delete s.value[m],delete r.value[m],t.value===m&&(t.value=null)},2e3))};return{testingProvider:t,batchTestingStates:s,getTestButtonTitle:o,getBatchTestButtonTitle:a,handleModelTestClick:h,batchTestModels:f}}function tr(){const i=Z(),e=ye(),t=xe.getInstance(),s=I(!1),r=I(""),n=I(null),o=I(!1),a=I({}),u=I(""),c=I(""),h=I({name:"",id:"",apiType:""}),f=ot(()=>{const b=a.value[r.value]||[];if(!c.value.trim())return b;const x=c.value.toLowerCase().trim().split(/\s+/);return b.filter(S=>{const D=S.toLowerCase();return x.every(Me=>D.includes(Me))})}),d=b=>i.providers.find(x=>x.id===b);return{showAddModelDialog:s,addingModelToProvider:r,editingModel:n,loadingModels:o,providerModelsCache:a,modelFetchError:u,modelSearchKeyword:c,newModel:h,getCurrentProviderModels:f,getProviderForModel:d,getApiTypeColor:b=>{switch(b){case"openai":return"bg-green-500";case"anthropic":return"bg-purple-500";case"google":return"bg-blue-500";default:return"bg-gray-500"}},getApiTypeLabel:b=>{switch(b){case"openai":return"OpenAI";case"anthropic":return"Claude";case"google":return"Gemini";default:return b}},showAddModel:b=>{n.value=null,r.value=b,o.value=!1,u.value="",c.value="";const x=d(b);let S="";(x==null?void 0:x.type)==="custom"?S="openai":x!=null&&x.type&&x.type in["openai","anthropic","google"]&&(S=x.type),h.value={name:"",id:"",apiType:S},s.value=!0},editModel:(b,x)=>{n.value=x,r.value=b,h.value={name:x.name,id:x.id,apiType:x.apiType||""},s.value=!0},closeAddModelDialog:()=>{s.value=!1,c.value="",r.value="",u.value="",n.value=null},addCustomModel:()=>{const b=i.providers.find(S=>S.id===r.value);if(!b)return;let x=h.value.apiType;if(b.type!=="custom"&&(x=b.type),n.value){if(b){const S=b.models.findIndex(D=>D.id===n.value.id);S>-1&&(b.models[S]={...b.models[S],name:h.value.name,id:h.value.id,apiType:x})}n.value=null}else i.addModel(r.value,{id:h.value.id,name:h.value.name,enabled:!0,apiType:x});h.value={name:"",id:"",apiType:""},s.value=!1,r.value="",i.saveSettings()},deleteModel:(b,x)=>{confirm("确定要删除这个模型吗？")&&(i.deleteModel(b,x),i.saveSettings(),e.success("模型已删除"))},fetchAvailableModels:async()=>{try{o.value=!0,u.value="";const b=r.value,x=d(b);if(!x)throw new Error("未找到提供商信息");if(!x.apiKey||!x.baseUrl)throw new Error("请先配置提供商的API密钥和基础URL");const S=h.value.apiType,D=await t.getAvailableModels(x,S);a.value[b]=D,D.length===0&&(u.value="未找到可用模型")}catch(b){u.value=b.message||"获取模型列表失败，请手动输入模型ID"}finally{o.value=!1}},selectModel:b=>{h.value.id=b,h.value.name||(h.value.name=b)}}}function sr(){const i=Z(),e=ye(),t=I(!1),s=I(!1),r=I(null),n=I("custom"),o=I({name:"",baseUrl:"",apiKey:""});return{showAddProviderTypeDialog:t,showAddProvider:s,editingProvider:r,selectedProviderType:n,newProvider:o,getProviderTemplate:g=>i.getProviderTemplate(g),getDefaultBaseUrl:g=>{switch(g){case"openai":return"https://api.openai.com/v1/chat/completions";case"anthropic":return"https://api.anthropic.com/v1/messages";case"google":return"https://generativelanguage.googleapis.com/v1beta";case"custom":return"https://api.example.com/v1";default:return""}},openAddProviderTypeDialog:()=>{t.value=!0},selectProviderType:g=>{if(t.value=!1,n.value=g,!r.value)if(g==="custom")o.value={name:"",baseUrl:"",apiKey:""};else{const y=i.getProviderTemplate(g);o.value={name:y.name,baseUrl:y.baseUrl||"",apiKey:""}}s.value=!0},editProvider:g=>{r.value=g,n.value=g.type,o.value={name:g.name,baseUrl:g.baseUrl||"",apiKey:g.apiKey||""},s.value=!0},closeProviderDialog:()=>{s.value=!1,r.value=null,o.value={name:"",baseUrl:"",apiKey:""}},saveProvider:()=>{try{if(r.value){const g=i.providers.find(y=>y.id===r.value.id);g&&(g.name=o.value.name,g.apiKey=o.value.apiKey,(g.allowCustomUrl||g.type==="custom")&&(g.baseUrl=o.value.baseUrl)),r.value=null}else i.addProvider(n.value,{name:o.value.name,baseUrl:o.value.baseUrl,apiKey:o.value.apiKey});o.value={name:"",baseUrl:"",apiKey:""},s.value=!1,i.saveSettings(),e.success(r.value?"提供商已更新":"提供商已添加")}catch(g){e.error(`保存失败: ${g}`)}},deleteProvider:g=>{confirm("确定要删除这个提供商吗？这将同时删除其所有模型配置。")&&(i.deleteProvider(g),i.saveSettings(),e.success("提供商已删除"))}}}function nr(){const i=Z();return{resetSystemPromptRules:()=>{confirm("确定要重置系统提示词规则为默认值吗？")&&i.resetSystemPromptRules()},resetUserPromptRules:()=>{confirm("确定要重置用户引导规则为默认值吗？")&&i.resetUserPromptRules()},resetRequirementReportRules:()=>{confirm("确定要重置需求报告规则为默认值吗？")&&i.resetRequirementReportRules()},resetThinkingPointsExtractionPrompt:()=>{confirm("确定要重置关键指令提取规则为默认值吗？")&&i.resetThinkingPointsExtractionPrompt()},resetSystemPromptGenerationPrompt:()=>{confirm("确定要重置系统提示词生成规则为默认值吗？")&&i.resetSystemPromptGenerationPrompt()},resetOptimizationAdvicePrompt:()=>{confirm("确定要重置优化建议生成规则为默认值吗？")&&i.resetOptimizationAdvicePrompt()},resetOptimizationApplicationPrompt:()=>{confirm("确定要重置优化应用规则为默认值吗？")&&i.resetOptimizationApplicationPrompt()},resetQualityAnalysisSystemPrompt:()=>{confirm("确定要重置质量分析系统提示词为默认值吗？")&&i.resetQualityAnalysisSystemPrompt()},resetUserPromptQualityAnalysis:()=>{confirm("确定要重置用户提示词质量分析规则为默认值吗？")&&i.resetUserPromptQualityAnalysis()},resetUserPromptQuickOptimization:()=>{confirm("确定要重置用户提示词快速优化规则为默认值吗？")&&i.resetUserPromptQuickOptimization()},handleSlimRulesToggle:()=>{i.loadPromptRules(),i.saveSettings()},saveAndClose:async()=>{try{(i.editingSystemRules||i.editingUserRules||i.editingRequirementReportRules||i.editingFinalPromptRules)&&await i.savePromptRules(),i.saveSettings(),i.showSettings=!1}catch(m){console.error("保存设置失败:",m),alert("保存失败，请检查网络连接后重试")}}}}const rr=Q({__name:"SettingsButton",emits:["open"],setup(i){return(e,t)=>(w(),A("button",{onClick:t[0]||(t[0]=s=>e.$emit("open")),class:"fixed top-4 right-4 z-50 p-2 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow",title:"设置"},[j(v(oe),{class:"w-5 h-5 text-gray-600"})]))}}),ns={class:"mb-6"},rs={class:"flex items-center justify-between mb-4"},is={key:0,class:"text-center py-8 text-gray-500"},os={key:1,class:"space-y-4"},ls={class:"flex items-center justify-between mb-3"},as={class:"flex items-center space-x-3"},us=["onUpdate:modelValue"],cs={class:"font-medium"},ps={class:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded"},ds={key:1,class:"flex items-center space-x-2 text-sm"},hs={class:"text-blue-600"},gs={class:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden"},fs={class:"flex items-center space-x-2"},ms=["onClick"],bs=["onClick","disabled","title"],xs=["onClick"],ys={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3"},ks=["onUpdate:modelValue"],vs={key:0},ws={class:"block text-sm font-medium text-gray-700 mb-1"},Ts={key:0,class:"text-xs text-gray-500"},$s=["onUpdate:modelValue","placeholder"],As={class:"flex items-center justify-between mb-2"},Ss=["onClick"],Ps={class:"space-y-2 max-h-32 overflow-y-auto"},Rs={class:"flex items-center space-x-2 flex-shrink-0"},Cs=["onUpdate:modelValue"],Ms={class:"text-sm font-medium whitespace-nowrap"},Is={class:"flex items-center space-x-1 flex-shrink-0"},Es=["title"],Us={key:1,class:"inline-flex items-center text-xs bg-green-100 text-green-800 rounded-full w-4 h-4 justify-center"},zs={key:2,class:"inline-flex items-center text-xs bg-red-100 text-red-800 rounded-full w-4 h-4 justify-center"},Os={class:"flex items-center space-x-1 flex-shrink-0"},Ls=["onClick","disabled","title"],Ns=["onClick"],Ds=["onClick"],ir=Q({__name:"ProvidersTab",props:{providers:{},batchTestingStates:{},testingProvider:{},getDefaultBaseUrl:{type:Function},getTestButtonTitle:{type:Function},getBatchTestButtonTitle:{type:Function},getApiTypeColor:{type:Function},getApiTypeLabel:{type:Function}},emits:["show-add-provider-type","edit-provider","delete-provider","batch-test","show-add-model","edit-model","delete-model","test-model","save"],setup(i){const e=Z(),t=s=>e.getReasoningTypeDescription(s);return(s,r)=>(w(),A("div",null,[l("div",ns,[l("div",rs,[r[6]||(r[6]=l("h3",{class:"text-lg font-medium"},"AI服务提供商",-1)),l("button",{onClick:r[0]||(r[0]=n=>s.$emit("show-add-provider-type")),class:"flex items-center space-x-1 px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600"},[j(v(pt),{class:"w-4 h-4"}),r[5]||(r[5]=l("span",null,"添加提供商",-1))])]),r[12]||(r[12]=lt('<div class="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"><h4 class="text-sm font-medium text-blue-800 mb-2">API配置说明</h4><div class="text-sm text-blue-700 space-y-2"><div><strong>OpenAI及兼容服务：</strong>API URL填写完整路径，如 <code class="bg-blue-100 px-1 rounded break-all text-xs">https://api.openai.com/v1/chat/completions</code></div><div><strong>Anthropic Claude：</strong>API URL填写 <code class="bg-blue-100 px-1 rounded break-all text-xs">https://api.anthropic.com/v1/messages</code></div><div><strong>Google Gemini：</strong>API URL填写 <code class="bg-blue-100 px-1 rounded break-all text-xs">https://generativelanguage.googleapis.com/v1beta</code>（系统会自动根据模型拼接路径）</div><div><strong>自定义提供商：</strong>大多数第三方服务使用OpenAI兼容格式，URL结构为 <code class="bg-blue-100 px-1 rounded break-all text-xs">https://你的域名/v1/chat/completions</code></div><div class="text-xs text-blue-600 mt-2">支持代理地址、中转API等各种自定义URL</div></div><div class="mt-3 pt-3 border-t border-blue-200"><h4 class="text-sm font-medium text-blue-800 mb-2">附件多模态支持</h4><div class="text-sm text-blue-700 space-y-1"><div><strong>OpenAI：</strong>支持图片（GPT-4 Vision及更高版本） <div class="text-xs text-blue-600 ml-4">• API支持格式：PNG, JPEG, WEBP, GIF</div><div class="text-xs text-blue-600 ml-4">• 注意：ChatGPT网页版支持PDF/Office文档，但API不支持</div></div><div><strong>Anthropic Claude：</strong>支持图片（Claude 3系列） <div class="text-xs text-blue-600 ml-4">• 图片格式：PNG, JPEG, WEBP, GIF</div><div class="text-xs text-blue-600 ml-4">• PDF文档：Claude 3.5+（最多100页）</div></div><div><strong>Google Gemini：</strong>全面支持图片、文档（PDF/Office）、音频、视频等多模态 <div class="text-xs text-blue-600 ml-4">• 图片：PNG, JPEG, WEBP, GIF, BMP, TIFF, SVG, HEIC</div><div class="text-xs text-blue-600 ml-4">• 文档：PDF, Office(Word/Excel/PPT), TXT, Markdown, CSV等</div><div class="text-xs text-blue-600 ml-4">• 音频：WAV, MP3, AAC, OGG, FLAC</div><div class="text-xs text-blue-600 ml-4">• 视频：MP4, MOV, AVI, WebM等</div></div><div class="text-xs text-blue-600 mt-2">💡 如需上传表格等文档，建议使用 Google Gemini 模型</div></div></div></div>',1)),s.providers.length===0?(w(),A("div",is,[j(v(oe),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),r[7]||(r[7]=l("p",null,"还没有配置任何AI提供商",-1)),r[8]||(r[8]=l("p",{class:"text-sm"},"点击上方按钮添加您的第一个AI服务",-1))])):(w(),A("div",os,[(w(!0),A(de,null,he(s.providers,n=>{var o,a;return w(),A("div",{key:n.id,class:"border rounded-lg p-4"},[l("div",ls,[l("div",as,[M(l("input",{"onUpdate:modelValue":u=>n.enabled=u,type:"checkbox",class:"rounded",onChange:r[1]||(r[1]=u=>s.$emit("save"))},null,40,us),[[ge,n.enabled]]),l("h4",cs,L(n.name),1),l("span",ps,L(n.type),1),n.enabled&&n.apiKey?(w(),J(v(at),{key:0,class:"w-4 h-4 text-green-600",title:"已配置"})):U("",!0),(o=s.batchTestingStates[n.id])!=null&&o.isTesting?(w(),A("div",ds,[l("span",hs,L(s.batchTestingStates[n.id].isAborted?"已停止测试":`测试中 ${s.batchTestingStates[n.id].currentModelIndex}/${s.batchTestingStates[n.id].totalModels}`),1),l("div",gs,[l("div",{class:"h-full bg-blue-500 transition-all duration-300",style:ut({width:`${s.batchTestingStates[n.id].currentModelIndex/s.batchTestingStates[n.id].totalModels*100}%`})},null,4)])])):U("",!0)]),l("div",fs,[l("button",{onClick:u=>s.$emit("edit-provider",n),class:"text-blue-500 hover:text-blue-700",title:"编辑提供商"},[j(v(oe),{class:"w-4 h-4"})],8,ms),l("button",{onClick:u=>s.$emit("batch-test",n),disabled:!n.apiKey||n.models.length===0,class:"text-green-500 hover:text-green-700 disabled:opacity-50 transition-colors",title:s.getBatchTestButtonTitle(n)},[(a=s.batchTestingStates[n.id])!=null&&a.isTesting?(w(),J(v(ze),{key:0,class:te(["w-4 h-4",{"animate-pulse":s.testingProvider===n.id}])},null,8,["class"])):(w(),J(v(Oe),{key:1,class:"w-4 h-4"}))],8,bs),l("button",{onClick:u=>s.$emit("delete-provider",n.id),class:"text-red-500 hover:text-red-700",title:"删除提供商"},[j(v(dt),{class:"w-4 h-4"})],8,xs)])]),l("div",ys,[l("div",null,[r[9]||(r[9]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"API密钥",-1)),M(l("input",{"onUpdate:modelValue":u=>n.apiKey=u,type:"password",placeholder:"输入API密钥",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:r[2]||(r[2]=u=>s.$emit("save"))},null,40,ks),[[O,n.apiKey]])]),n.allowCustomUrl||n.type==="custom"?(w(),A("div",vs,[l("label",ws,[r[10]||(r[10]=Fe(" API URL ",-1)),n.type!=="custom"?(w(),A("span",Ts,"(可选，留空使用官方完整地址)")):U("",!0)]),M(l("input",{"onUpdate:modelValue":u=>n.baseUrl=u,type:"url",placeholder:s.getDefaultBaseUrl(n.type),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:r[3]||(r[3]=u=>s.$emit("save"))},null,40,$s),[[O,n.baseUrl]])])):U("",!0)]),l("div",null,[l("div",As,[r[11]||(r[11]=l("label",{class:"text-sm font-medium text-gray-700"},"可用模型",-1)),l("button",{onClick:u=>s.$emit("show-add-model",n.id),class:"text-sm text-blue-500 hover:text-blue-700"}," 添加模型 ",8,Ss)]),l("div",Ps,[(w(!0),A(de,null,he(n.models,u=>{var c,h,f;return w(),A("div",{key:u.id,class:"relative flex items-center justify-between p-2 bg-gray-50 rounded min-w-0 overflow-x-auto"},[l("div",Rs,[M(l("input",{"onUpdate:modelValue":d=>u.enabled=d,type:"checkbox",class:"rounded flex-shrink-0",onChange:r[4]||(r[4]=d=>s.$emit("save"))},null,40,Cs),[[ge,u.enabled]]),l("span",Ms,L(u.name),1),l("div",Is,[(c=u.capabilities)!=null&&c.reasoning?(w(),A("span",{key:0,class:"inline-flex items-center text-xs bg-purple-100 text-purple-800 rounded-full w-4 h-4 justify-center",title:t(u.capabilities.reasoningType)}," 🧠 ",8,Es)):U("",!0),(f=(h=u.capabilities)==null?void 0:h.testResult)!=null&&f.connected?(w(),A("span",Us," ✅ ")):U("",!0),u.testStatus==="failed"?(w(),A("span",zs," ❌ ")):U("",!0)]),u.apiType?(w(),A("span",{key:0,class:te(["text-xs px-1.5 py-0.5 rounded text-white flex-shrink-0",s.getApiTypeColor(u.apiType)])},L(s.getApiTypeLabel(u.apiType)),3)):U("",!0)]),l("div",Os,[l("button",{onClick:d=>s.$emit("test-model",n.id,u.id,u.testStatus),disabled:!n.apiKey,class:te(["transition-colors text-sm",u.testStatus==="testing"?"text-blue-600 hover:text-blue-800":u.testStatus==="success"?"text-green-500 hover:text-green-700":u.testStatus==="failed"?"text-red-500 hover:text-red-700":"text-gray-400 hover:text-blue-500"]),title:s.getTestButtonTitle(u)},[u.testStatus==="testing"?(w(),J(v(ze),{key:0,class:"w-3 h-3 animate-pulse"})):(w(),J(v(Oe),{key:1,class:"w-3 h-3"}))],10,Ls),l("button",{onClick:d=>s.$emit("edit-model",n.id,u),class:"text-blue-500 hover:text-blue-700",title:"编辑模型"},[j(v(oe),{class:"w-3 h-3"})],8,Ns),l("button",{onClick:d=>s.$emit("delete-model",n.id,u.id),class:"text-red-500 hover:text-red-700",title:"删除模型"},[j(v(ct),{class:"w-3 h-3"})],8,Ds)])])}),128))])])])}),128))]))])]))}}),js={class:"space-y-6"},Gs={class:"border border-gray-300 rounded-lg overflow-hidden"},Bs={class:"flex items-center gap-2"},qs={class:"p-4 space-y-6 bg-white"},Fs={class:"flex items-center justify-between mb-3"},Vs={class:"flex items-center space-x-3"},Ks={class:"flex items-center space-x-2 cursor-pointer"},Ws={class:"relative"},_s={class:"flex items-center justify-between mb-3"},Zs={class:"flex items-center justify-between mb-3"},Qs={class:"space-y-4"},Hs={class:"flex items-center justify-between mb-2"},Js={class:"flex items-center justify-between mb-2"},Xs={class:"flex items-center justify-between mb-2"},Ys={class:"flex items-center justify-between mb-2"},en={class:"border border-gray-300 rounded-lg overflow-hidden"},tn={class:"flex items-center gap-2"},sn={class:"p-4 space-y-6 bg-white"},nn={class:"space-y-4 pl-4 border-l-2 border-green-200"},rn={class:"flex items-center justify-between mb-2"},on={class:"flex items-center justify-between mb-2"},ln={class:"flex items-center justify-between mb-2"},an={class:"space-y-4 pl-4 border-l-2 border-green-200"},un={class:"flex items-center justify-between mb-2"},cn={class:"flex items-center justify-between mb-2"},or=Q({__name:"PromptsTab",emits:["reset-system","reset-user","reset-requirement","reset-quality-analysis-system","reset-thinking","reset-generation","reset-advice","reset-application","toggle-slim-rules","reset-user-prompt-quality-analysis","reset-user-prompt-quick-optimization"],setup(i){const e=Z(),t=I(!0),s=I(!1);return(r,n)=>(w(),A("div",js,[l("div",Gs,[l("button",{onClick:n[0]||(n[0]=o=>t.value=!t.value),class:"w-full px-4 py-3 bg-blue-50 hover:bg-blue-100 flex items-center justify-between transition-colors"},[l("div",Bs,[j(v(Ue),{class:te(["w-5 h-5 text-blue-600 transition-transform",t.value&&"transform rotate-180"])},null,8,["class"]),n[28]||(n[28]=l("h2",{class:"text-lg font-semibold text-blue-900"},"生成规则",-1))]),n[29]||(n[29]=l("span",{class:"text-xs text-blue-600"},"用于提示词生成功能",-1))]),M(l("div",qs,[l("div",null,[l("div",Fs,[n[32]||(n[32]=l("h3",{class:"text-lg font-medium"},"系统提示词规则",-1)),l("div",Vs,[l("label",Ks,[n[31]||(n[31]=l("span",{class:"text-sm text-gray-600"},"精简版",-1)),l("div",Ws,[M(l("input",{type:"checkbox","onUpdate:modelValue":n[1]||(n[1]=o=>v(e).useSlimRules=o),onChange:n[2]||(n[2]=o=>r.$emit("toggle-slim-rules")),class:"sr-only peer"},null,544),[[ge,v(e).useSlimRules]]),n[30]||(n[30]=l("div",{class:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])]),l("button",{onClick:n[3]||(n[3]=o=>r.$emit("reset-system")),class:"text-sm text-gray-500 hover:text-gray-700 px-2 py-1 border border-gray-300 rounded"}," 重置为默认 ")])]),M(l("textarea",{"onUpdate:modelValue":n[4]||(n[4]=o=>v(e).editingSystemRules=o),placeholder:"输入系统提示词规则...",class:"w-full h-48 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingSystemRules]]),n[33]||(n[33]=l("p",{class:"text-xs text-gray-500 mt-1"},"系统提示词包含AI提示词工程的完整指南，用于生成高质量的提示词。",-1))]),l("div",null,[l("div",_s,[n[34]||(n[34]=l("h3",{class:"text-lg font-medium"},"用户引导规则",-1)),l("button",{onClick:n[5]||(n[5]=o=>r.$emit("reset-user")),class:"text-sm text-gray-500 hover:text-gray-700 px-2 py-1 border border-gray-300 rounded"}," 重置为默认 ")]),M(l("textarea",{"onUpdate:modelValue":n[6]||(n[6]=o=>v(e).editingUserRules=o),placeholder:"输入用户引导规则...",class:"w-full h-48 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingUserRules]]),n[35]||(n[35]=l("p",{class:"text-xs text-gray-500 mt-1"},"用户引导规则定义AI助手在对话中的行为方式，包括智能判断和对话终止机制。",-1))]),l("div",null,[l("div",Zs,[n[36]||(n[36]=l("h3",{class:"text-lg font-medium"},"需求报告规则",-1)),l("button",{onClick:n[7]||(n[7]=o=>r.$emit("reset-requirement")),class:"text-sm text-gray-500 hover:text-gray-700 px-2 py-1 border border-gray-300 rounded"}," 重置为默认 ")]),M(l("textarea",{"onUpdate:modelValue":n[8]||(n[8]=o=>v(e).editingRequirementReportRules=o),placeholder:"输入需求报告生成规则...",class:"w-full h-48 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingRequirementReportRules]]),n[37]||(n[37]=l("p",{class:"text-xs text-gray-500 mt-1"},"需求报告规则用于基于用户对话历史生成完整的需求总结报告。",-1))]),l("div",null,[n[42]||(n[42]=l("div",{class:"mb-3"},[l("h3",{class:"text-lg font-medium"},"最终提示词生成规则")],-1)),l("div",Qs,[l("div",null,[l("div",Hs,[n[38]||(n[38]=l("h4",{class:"text-sm font-medium text-gray-700"},"关键指令提取",-1)),l("button",{onClick:n[9]||(n[9]=o=>r.$emit("reset-thinking")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置为默认 ")]),M(l("textarea",{"onUpdate:modelValue":n[10]||(n[10]=o=>v(e).editingFinalPromptRules.THINKING_POINTS_EXTRACTION=o),placeholder:"输入关键指令提取规则...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingFinalPromptRules.THINKING_POINTS_EXTRACTION]])]),l("div",null,[l("div",Js,[n[39]||(n[39]=l("h4",{class:"text-sm font-medium text-gray-700"},"系统提示词生成",-1)),l("button",{onClick:n[11]||(n[11]=o=>r.$emit("reset-generation")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置为默认 ")]),M(l("textarea",{"onUpdate:modelValue":n[12]||(n[12]=o=>v(e).editingFinalPromptRules.SYSTEM_PROMPT_GENERATION=o),placeholder:"输入系统提示词生成规则...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingFinalPromptRules.SYSTEM_PROMPT_GENERATION]])]),l("div",null,[l("div",Xs,[n[40]||(n[40]=l("h4",{class:"text-sm font-medium text-gray-700"},"优化建议生成",-1)),l("button",{onClick:n[13]||(n[13]=o=>r.$emit("reset-advice")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置为默认 ")]),M(l("textarea",{"onUpdate:modelValue":n[14]||(n[14]=o=>v(e).editingFinalPromptRules.OPTIMIZATION_ADVICE_GENERATION=o),placeholder:"输入优化建议生成规则...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingFinalPromptRules.OPTIMIZATION_ADVICE_GENERATION]])]),l("div",null,[l("div",Ys,[n[41]||(n[41]=l("h4",{class:"text-sm font-medium text-gray-700"},"优化应用",-1)),l("button",{onClick:n[15]||(n[15]=o=>r.$emit("reset-application")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置为默认 ")]),M(l("textarea",{"onUpdate:modelValue":n[16]||(n[16]=o=>v(e).editingFinalPromptRules.OPTIMIZATION_APPLICATION=o),placeholder:"输入优化应用规则...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingFinalPromptRules.OPTIMIZATION_APPLICATION]])])]),n[43]||(n[43]=l("p",{class:"text-xs text-gray-500 mt-1"},"最终提示词生成规则用于控制提示词生成器的各个步骤的系统提示词。",-1))])],512),[[Ee,t.value]])]),l("div",en,[l("button",{onClick:n[17]||(n[17]=o=>s.value=!s.value),class:"w-full px-4 py-3 bg-green-50 hover:bg-green-100 flex items-center justify-between transition-colors"},[l("div",tn,[j(v(Ue),{class:te(["w-5 h-5 text-green-600 transition-transform",s.value&&"transform rotate-180"])},null,8,["class"]),n[44]||(n[44]=l("h2",{class:"text-lg font-semibold text-green-900"},"优化规则",-1))]),n[45]||(n[45]=l("span",{class:"text-xs text-green-600"},"用于提示词优化功能",-1))]),M(l("div",sn,[l("div",null,[n[52]||(n[52]=l("div",{class:"flex items-center justify-between mb-3"},[l("h3",{class:"text-lg font-medium"},"系统提示词优化")],-1)),n[53]||(n[53]=l("p",{class:"text-sm text-gray-600 mb-3"},"三段式优化流程：质量分析 → 优化建议 → 应用优化",-1)),l("div",nn,[l("div",null,[l("div",rn,[n[46]||(n[46]=l("h4",{class:"text-sm font-medium text-gray-700"},"1. 质量分析系统提示词",-1)),l("button",{onClick:n[18]||(n[18]=o=>r.$emit("reset-quality-analysis-system")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置 ")]),M(l("textarea",{"onUpdate:modelValue":n[19]||(n[19]=o=>v(e).editingQualityAnalysisRules.systemPrompt=o),placeholder:"输入质量分析系统提示词...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingQualityAnalysisRules.systemPrompt]]),n[47]||(n[47]=l("p",{class:"text-xs text-gray-500 mt-1"},"分析提示词的结构、清晰度、完整性等质量问题",-1))]),l("div",null,[l("div",on,[n[48]||(n[48]=l("h4",{class:"text-sm font-medium text-gray-700"},"2. 优化建议生成",-1)),l("button",{onClick:n[20]||(n[20]=o=>r.$emit("reset-advice")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置 ")]),M(l("textarea",{"onUpdate:modelValue":n[21]||(n[21]=o=>v(e).editingFinalPromptRules.OPTIMIZATION_ADVICE_GENERATION=o),placeholder:"输入优化建议生成规则...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingFinalPromptRules.OPTIMIZATION_ADVICE_GENERATION]]),n[49]||(n[49]=l("p",{class:"text-xs text-gray-500 mt-1"},"基于质量分析结果生成具体的优化建议",-1))]),l("div",null,[l("div",ln,[n[50]||(n[50]=l("h4",{class:"text-sm font-medium text-gray-700"},"3. 优化应用",-1)),l("button",{onClick:n[22]||(n[22]=o=>r.$emit("reset-application")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置 ")]),M(l("textarea",{"onUpdate:modelValue":n[23]||(n[23]=o=>v(e).editingFinalPromptRules.OPTIMIZATION_APPLICATION=o),placeholder:"输入优化应用规则...",class:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingFinalPromptRules.OPTIMIZATION_APPLICATION]]),n[51]||(n[51]=l("p",{class:"text-xs text-gray-500 mt-1"},"根据优化建议生成优化后的提示词",-1))])])]),l("div",null,[n[58]||(n[58]=l("div",{class:"flex items-center justify-between mb-3"},[l("h3",{class:"text-lg font-medium"},"用户提示词优化")],-1)),n[59]||(n[59]=l("p",{class:"text-sm text-gray-600 mb-3"},"两段式优化流程：质量分析 → 快速优化",-1)),l("div",an,[l("div",null,[l("div",un,[n[54]||(n[54]=l("h4",{class:"text-sm font-medium text-gray-700"},"1. 质量分析系统提示词",-1)),l("button",{onClick:n[24]||(n[24]=o=>r.$emit("reset-user-prompt-quality-analysis")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置 ")]),M(l("textarea",{"onUpdate:modelValue":n[25]||(n[25]=o=>v(e).editingUserPromptOptimizationRules.qualityAnalysis=o),placeholder:"输入质量分析系统提示词...",class:"w-full h-48 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingUserPromptOptimizationRules.qualityAnalysis]]),n[55]||(n[55]=l("p",{class:"text-xs text-gray-500 mt-1"},"分析用户草稿的清晰度、特定性、结构、上下文、完整性等维度，输出JSON格式的分析结果",-1))]),l("div",null,[l("div",cn,[n[56]||(n[56]=l("h4",{class:"text-sm font-medium text-gray-700"},"2. 快速优化系统提示词",-1)),l("button",{onClick:n[26]||(n[26]=o=>r.$emit("reset-user-prompt-quick-optimization")),class:"text-xs text-gray-400 hover:text-gray-600 px-1 py-0.5 border border-gray-200 rounded"}," 重置 ")]),M(l("textarea",{"onUpdate:modelValue":n[27]||(n[27]=o=>v(e).editingUserPromptOptimizationRules.quickOptimization=o),placeholder:"输入快速优化系统提示词...",class:"w-full h-48 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none text-xs"},null,512),[[O,v(e).editingUserPromptOptimizationRules.quickOptimization]]),n[57]||(n[57]=l("p",{class:"text-xs text-gray-500 mt-1"},"根据质量分析结果优化用户草稿，包含角色防混淆、长度控制、自然语言风格等完整规则",-1))])])])],512),[[Ee,s.value]])])]))}}),pn={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4"},dn={class:"bg-white rounded-lg max-w-md w-full p-6"},hn={class:"space-y-3"},gn={class:"flex justify-end space-x-3 mt-6"},lr=Q({__name:"ProviderTypeDialog",emits:["select","close"],setup(i){return(e,t)=>(w(),A("div",pn,[l("div",dn,[t[9]||(t[9]=l("h3",{class:"text-lg font-semibold mb-4"},"选择提供商类型",-1)),l("div",hn,[l("button",{onClick:t[0]||(t[0]=s=>e.$emit("select","openai")),class:"w-full p-4 border border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 text-left transition-colors"},[...t[5]||(t[5]=[l("div",{class:"flex items-center space-x-3"},[l("div",{class:"w-3 h-3 rounded-full bg-green-500"}),l("div",null,[l("h4",{class:"font-medium"},"OpenAI"),l("p",{class:"text-sm text-gray-500"},"官方OpenAI API或兼容服务")])],-1)])]),l("button",{onClick:t[1]||(t[1]=s=>e.$emit("select","anthropic")),class:"w-full p-4 border border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 text-left transition-colors"},[...t[6]||(t[6]=[l("div",{class:"flex items-center space-x-3"},[l("div",{class:"w-3 h-3 rounded-full bg-purple-500"}),l("div",null,[l("h4",{class:"font-medium"},"Anthropic"),l("p",{class:"text-sm text-gray-500"},"官方Claude API或兼容服务")])],-1)])]),l("button",{onClick:t[2]||(t[2]=s=>e.$emit("select","google")),class:"w-full p-4 border border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 text-left transition-colors"},[...t[7]||(t[7]=[l("div",{class:"flex items-center space-x-3"},[l("div",{class:"w-3 h-3 rounded-full bg-blue-500"}),l("div",null,[l("h4",{class:"font-medium"},"Gemini"),l("p",{class:"text-sm text-gray-500"},"官方Gemini API或兼容服务")])],-1)])]),l("button",{onClick:t[3]||(t[3]=s=>e.$emit("select","custom")),class:"w-full p-4 border border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 text-left transition-colors"},[...t[8]||(t[8]=[l("div",{class:"flex items-center space-x-3"},[l("div",{class:"w-3 h-3 rounded-full bg-gray-500"}),l("div",null,[l("h4",{class:"font-medium"},"自定义服务"),l("p",{class:"text-sm text-gray-500"},"第三方API服务或中转代理")])],-1)])])]),l("div",gn,[l("button",{onClick:t[4]||(t[4]=s=>e.$emit("close")),class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50"}," 取消 ")])])]))}}),fn={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4"},mn={class:"bg-white rounded-lg max-w-md w-full p-6"},bn={class:"text-lg font-semibold mb-4"},xn={class:"space-y-4"},yn=["value","placeholder"],kn={key:0},vn={class:"block text-sm font-medium text-gray-700 mb-1"},wn={key:0,class:"text-xs text-gray-500"},Tn=["value","placeholder"],$n=["value"],An={class:"flex justify-end space-x-3 mt-6"},Sn=["disabled"],ar=Q({__name:"ProviderDialog",props:{editing:{type:Boolean},providerType:{},name:{},baseUrl:{},apiKey:{},getDefaultBaseUrl:{type:Function},getProviderTemplate:{type:Function}},emits:["update:name","update:baseUrl","update:apiKey","save","close"],setup(i){return(e,t)=>(w(),A("div",fn,[l("div",mn,[l("h3",bn,L(e.editing?"编辑提供商":`添加${e.providerType==="custom"?"自定义":""}提供商`),1),l("div",xn,[l("div",null,[t[5]||(t[5]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"提供商名称",-1)),l("input",{value:e.name,onInput:t[0]||(t[0]=s=>e.$emit("update:name",s.target.value)),type:"text",placeholder:e.providerType==="custom"?"例如：DeepSeek":"可自定义名称",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,40,yn)]),e.providerType==="custom"||e.providerType&&["openai","anthropic","google"].includes(e.providerType)&&e.getProviderTemplate(e.providerType).allowCustomUrl?(w(),A("div",kn,[l("label",vn,[t[6]||(t[6]=Fe(" API URL ",-1)),e.providerType!=="custom"?(w(),A("span",wn,"(可选，留空使用官方完整地址)")):U("",!0)]),l("input",{value:e.baseUrl,onInput:t[1]||(t[1]=s=>e.$emit("update:baseUrl",s.target.value)),type:"url",placeholder:e.getDefaultBaseUrl(e.providerType),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,40,Tn)])):U("",!0),l("div",null,[t[7]||(t[7]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"API密钥",-1)),l("input",{value:e.apiKey,onInput:t[2]||(t[2]=s=>e.$emit("update:apiKey",s.target.value)),type:"password",placeholder:"输入API密钥",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,40,$n)])]),l("div",An,[l("button",{onClick:t[3]||(t[3]=s=>e.$emit("close")),class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50"}," 取消 "),l("button",{onClick:t[4]||(t[4]=s=>e.$emit("save")),disabled:!e.name||e.providerType==="custom"&&!e.baseUrl,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50"},L(e.editing?"保存":"添加"),9,Sn)])])]))}}),Pn={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4"},Rn={class:"bg-white rounded-lg max-w-md w-full p-6"},Cn={class:"text-lg font-semibold mb-4"},Mn={class:"space-y-4"},In=["value"],En={class:"flex items-center justify-between mb-1"},Un=["disabled"],zn=["value"],On={key:0,class:"mt-2"},Ln={class:"mb-2"},Nn=["value"],Dn={key:0,class:"text-xs text-gray-500 mb-2"},jn={key:1,class:"text-xs text-gray-500 mb-2"},Gn={class:"max-h-32 overflow-y-auto border border-gray-200 rounded"},Bn=["onClick"],qn={class:"font-mono"},Fn={key:1,class:"mt-2"},Vn={class:"text-xs text-red-600"},Kn={key:0},Wn=["value"],_n={class:"flex justify-end space-x-3 mt-6"},Zn=["disabled"],ur=Q({__name:"ModelDialog",props:{editing:{type:Boolean},provider:{},name:{},id:{},apiType:{},searchKeyword:{},availableModels:{},loading:{type:Boolean},error:{}},emits:["update:name","update:id","update:apiType","update:searchKeyword","fetch-models","select-model","save","close"],setup(i){return(e,t)=>{var s,r,n;return w(),A("div",Pn,[l("div",Rn,[l("h3",Cn,L(e.editing?"编辑模型":"添加模型"),1),l("div",Mn,[l("div",null,[t[7]||(t[7]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模型名称",-1)),l("input",{value:e.name,onInput:t[0]||(t[0]=o=>e.$emit("update:name",o.target.value)),type:"text",placeholder:"例如：DeepSeek Chat",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,40,In)]),l("div",null,[l("div",En,[t[8]||(t[8]=l("label",{class:"block text-sm font-medium text-gray-700"},"模型ID",-1)),((s=e.provider)==null?void 0:s.type)!=="anthropic"?(w(),A("button",{key:0,onClick:t[1]||(t[1]=o=>e.$emit("fetch-models")),disabled:e.loading,class:"text-xs text-blue-500 hover:text-blue-700 disabled:opacity-50"},L(e.loading?"获取中...":"🔄 获取模型列表"),9,Un)):U("",!0)]),l("input",{value:e.id,onInput:t[2]||(t[2]=o=>e.$emit("update:id",o.target.value)),type:"text",placeholder:"例如：deepseek-chat",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,40,zn),e.availableModels.length>0?(w(),A("div",On,[t[9]||(t[9]=l("p",{class:"text-xs text-gray-600 mb-2"},"点击选择模型：",-1)),l("div",Ln,[l("input",{value:e.searchKeyword,onInput:t[3]||(t[3]=o=>e.$emit("update:searchKeyword",o.target.value)),type:"text",placeholder:"🔍 输入关键词筛选模型... (支持多个关键词用空格分隔)",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent placeholder-gray-400"},null,40,Nn)]),e.searchKeyword.trim()&&e.availableModels.length===0?(w(),A("div",Dn,' 未找到包含 "'+L(e.searchKeyword)+'" 的模型 ',1)):e.searchKeyword.trim()?(w(),A("div",jn," 找到 "+L(e.availableModels.length)+" 个匹配的模型 ",1)):U("",!0),l("div",Gn,[(w(!0),A(de,null,he(e.availableModels,o=>(w(),A("div",{key:o,onClick:a=>e.$emit("select-model",o),class:"px-3 py-2 text-sm cursor-pointer hover:bg-blue-50 border-b border-gray-100 last:border-b-0"},[l("span",qn,L(o),1)],8,Bn))),128))])])):U("",!0),e.error?(w(),A("div",Fn,[l("p",Vn,L(e.error),1)])):U("",!0)]),((r=e.provider)==null?void 0:r.type)==="custom"?(w(),A("div",Kn,[t[11]||(t[11]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"API类型",-1)),l("select",{value:e.apiType,onChange:t[4]||(t[4]=o=>e.$emit("update:apiType",o.target.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[10]||(t[10]=[l("option",{value:""},"选择API类型",-1),l("option",{value:"openai"},"OpenAI 兼容",-1),l("option",{value:"anthropic"},"Anthropic 兼容",-1),l("option",{value:"google"},"Gemini 兼容",-1)])],40,Wn),t[12]||(t[12]=l("p",{class:"text-xs text-gray-500 mt-1"}," 选择此模型使用的API协议类型。大多数第三方代理服务使用OpenAI兼容格式。 ",-1))])):U("",!0)]),l("div",_n,[l("button",{onClick:t[5]||(t[5]=o=>e.$emit("close")),class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50"}," 取消 "),l("button",{onClick:t[6]||(t[6]=o=>e.$emit("save")),disabled:!e.name||!e.id||((n=e.provider)==null?void 0:n.type)==="custom"&&!e.apiType,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50"},L(e.editing?"保存":"添加"),9,Zn)])])])}}});export{Xn as A,Ue as C,Yn as R,dt as T,rr as _,xe as a,tr as b,sr as c,P as d,nr as e,ir as f,or as g,lr as h,ar as i,ur as j,er as u};
